"use strict";
var ProjectRepository = require("../dataaccess/repository/ProjectRepository");
var BuildingRepository = require("../dataaccess/repository/BuildingRepository");
var UserService = require("./../../framework/services/UserService");
var ProjectAsset = require("../../framework/shared/projectasset");
var BuildingReport = require("../dataaccess/model/project/reports/BuildingReport");
var ThumbRuleReport = require("../dataaccess/model/project/reports/ThumbRuleReport");
var AuthInterceptor = require("../../framework/interceptor/auth.interceptor");
var EstimateReport = require("../dataaccess/model/project/reports/EstimateReport");
var ProjectReport = require("../dataaccess/model/project/reports/ProjectReport");
var ThumbRule = require("../dataaccess/model/project/building/ThumbRule");
var Estimate = require("../dataaccess/model/project/building/Estimate");
var RateAnalysisService = require("./RateAnalysisService");
var alasql = require("alasql");
var Constants = require("../shared/constants");
var ProjectService = require("./ProjectService");
var MaterialTakeOffFlatDetailsDTO = require("../dataaccess/dto/Report/MaterialTakeOffFlatDetailsDTO");
var MaterialTakeOffFiltersListDTO = require("../dataaccess/dto/Report/MaterialTakeOffFiltersListDTO");
var MaterialTakeOffReport = require("../dataaccess/model/project/reports/MaterialTakeOffReport");
var MaterialTakeOffTableView = require("../dataaccess/model/project/reports/MaterialTakeOffTableView");
var MaterialTakeOffSecondaryView = require("../dataaccess/model/project/reports/MaterialTakeOffSecondaryView");
var MaterialTakeOffTableViewContent = require("../dataaccess/model/project/reports/MaterialTakeOffTableViewContent");
var MaterialTakeOffTableViewSubContent = require("../dataaccess/model/project/reports/MaterialTakeOffTableViewSubContent");
var MaterialTakeOffTableViewHeaders = require("../dataaccess/model/project/reports/MaterialTakeOffTableViewHeaders");
var MaterialTakeOffTableViewFooter = require("../dataaccess/model/project/reports/MaterialTakeOffTableViewFooter");
var config = require('config');
var log4js = require('log4js');
var logger = log4js.getLogger('Report Service');
var ReportService = (function () {
    function ReportService() {
        this.projectRepository = new ProjectRepository();
        this.buildingRepository = new BuildingRepository();
        this.APP_NAME = ProjectAsset.APP_NAME;
        this.authInterceptor = new AuthInterceptor();
        this.userService = new UserService();
        this.rateAnalysisService = new RateAnalysisService();
    }
    ReportService.prototype.getReport = function (projectId, reportType, rateUnit, areaType, user, callback) {
        var _this = this;
        logger.info('Report Service, getReport has been hit');
        var query = { _id: projectId };
        var populate = { path: 'buildings' };
        this.projectRepository.findAndPopulate(query, populate, function (error, result) {
            logger.info('Report Service, findAndPopulate has been hit');
            if (error) {
                callback(error, null);
            }
            else {
                var buildings = result[0].buildings;
                var typeOfArea;
                var totalArea = void 0;
                var choice = areaType;
                switch (choice) {
                    case Constants.SLAB_AREA:
                        {
                            typeOfArea = Constants.TOTAL_SLAB_AREA;
                            break;
                        }
                    case Constants.SALEABLE_AREA:
                        {
                            typeOfArea = Constants.TOTAL_SALEABLE_AREA;
                            break;
                        }
                    case Constants.CARPET_AREA:
                        {
                            typeOfArea = Constants.TOTAL_CARPET_AREA;
                            break;
                        }
                    default: callback(error, null);
                }
                var totalOfArea = alasql('VALUE OF SELECT ROUND(SUM(' + typeOfArea + '),2) FROM ?', [buildings]);
                if (rateUnit === Constants.SQUREMETER_UNIT) {
                    totalArea = Math.round(totalOfArea * config.get(Constants.SQUARE_METER));
                }
                else {
                    totalArea = totalOfArea;
                }
                var projectReport = new ProjectReport();
                projectReport.buildings = _this.generateReportByCostHeads(buildings, typeOfArea, rateUnit);
                var projectCostHeads = result[0].projectCostHeads;
                var projectRates = result[0].rates;
                if (projectCostHeads !== null) {
                    projectReport.commonAmenities = _this.generateReportForProjectCostHeads(projectCostHeads, projectRates, totalArea, rateUnit);
                }
                else {
                    callback(null, error);
                }
                callback(null, { data: projectReport, access_token: _this.authInterceptor.issueTokenWithUid(user) });
            }
        });
    };
    ReportService.prototype.generateReportByCostHeads = function (buildings, typeOfArea, rateUnit) {
        var buildingsReport = new Array();
        for (var _i = 0, buildings_1 = buildings; _i < buildings_1.length; _i++) {
            var building = buildings_1[_i];
            var buildingReport = new BuildingReport;
            buildingReport.name = building.name;
            buildingReport._id = building._id;
            if (rateUnit === Constants.SQUREMETER_UNIT) {
                buildingReport.area = Math.round(building[typeOfArea] * config.get(Constants.SQUARE_METER));
            }
            else {
                buildingReport.area = building[typeOfArea];
            }
            var thumbRule = new ThumbRule();
            var estimate = new Estimate();
            var thumbRuleReports = new Array();
            var estimatedReports = new Array();
            this.getThumbRuleAndEstimatedReport(building, buildingReport, thumbRuleReports, estimatedReports, rateUnit);
            var totalRates = alasql('SELECT ROUND(SUM(amount),2) AS totalAmount, ROUND(SUM(rate),2) AS totalRate FROM ?', [thumbRuleReports]);
            thumbRule.totalRate = totalRates[0].totalRate;
            thumbRule.totalBudgetedCost = Math.round(totalRates[0].totalAmount);
            thumbRule.thumbRuleReports = thumbRuleReports;
            var totalEstimatedRates = alasql('SELECT ROUND(SUM(total),2) AS totalAmount, ROUND(SUM(rate),2) AS totalRate FROM ?', [estimatedReports]);
            estimate.totalRate = totalEstimatedRates[0].totalRate;
            estimate.totalEstimatedCost = Math.round(totalEstimatedRates[0].totalAmount);
            estimate.estimatedCosts = estimatedReports;
            buildingReport.thumbRule = thumbRule;
            buildingReport.estimate = estimate;
            buildingsReport.push(buildingReport);
        }
        return (buildingsReport);
    };
    ReportService.prototype.getThumbRuleAndEstimatedReport = function (building, buildingReport, thumbRuleReports, estimatedReports, rateUnit) {
        for (var _i = 0, _a = building.costHeads; _i < _a.length; _i++) {
            var costHead = _a[_i];
            if (costHead.active) {
                var thumbRuleReport = new ThumbRuleReport();
                thumbRuleReport.name = costHead.name;
                thumbRuleReport.rateAnalysisId = costHead.rateAnalysisId;
                thumbRuleReport.amount = Math.round(costHead.budgetedCostAmount);
                thumbRuleReport.costHeadActive = costHead.active;
                thumbRuleReport.rate = parseFloat((thumbRuleReport.amount / buildingReport.area).toFixed(2));
                thumbRuleReports.push(thumbRuleReport);
                var estimateReport = new EstimateReport();
                estimateReport = this.getEstimatedReport(building.rates, costHead, buildingReport.area, rateUnit);
                estimatedReports.push(estimateReport);
            }
        }
    };
    ReportService.prototype.getEstimatedReport = function (centralizedRates, costHead, area, rateUnit) {
        var estimateReport = new EstimateReport();
        estimateReport.name = costHead.name;
        estimateReport.rateAnalysisId = costHead.rateAnalysisId;
        var costHeadCategories = costHead.categories;
        var projectService = new ProjectService();
        var categoriesObj = projectService.getCategoriesListWithCentralizedRates(costHeadCategories, centralizedRates);
        estimateReport.total = categoriesObj.categoriesAmount;
        estimateReport.rate = parseFloat((estimateReport.total / area).toFixed(2));
        return estimateReport;
    };
    ReportService.prototype.generateReportForProjectCostHeads = function (projectCostHeads, projectRates, totalArea, rateUnit) {
        var commonAmenitiesReport = new Array();
        var projectReport = new BuildingReport;
        projectReport.name = Constants.AMENITIES;
        projectReport.area = totalArea;
        var thumbRule = new ThumbRule();
        var estimate = new Estimate();
        var thumbRuleReports = new Array();
        var estimatedReports = new Array();
        this.getThumbRuleAndEstimatedReportForProjectCostHead(projectCostHeads, projectRates, projectReport, thumbRuleReports, estimatedReports, totalArea, rateUnit);
        var totalRates = alasql('SELECT ROUND(SUM(amount),2) AS totalAmount, ROUND(SUM(rate),2) AS totalRate FROM ?', [thumbRuleReports]);
        thumbRule.totalRate = totalRates[0].totalRate;
        thumbRule.totalBudgetedCost = Math.round(totalRates[0].totalAmount);
        thumbRule.thumbRuleReports = thumbRuleReports;
        var totalEstimatedRates = alasql('SELECT ROUND(SUM(total),2) AS totalAmount, ROUND(SUM(rate),2) AS totalRate FROM ?', [estimatedReports]);
        estimate.totalRate = totalEstimatedRates[0].totalRate;
        estimate.totalEstimatedCost = Math.round(totalEstimatedRates[0].totalAmount);
        estimate.estimatedCosts = estimatedReports;
        projectReport.thumbRule = thumbRule;
        projectReport.estimate = estimate;
        commonAmenitiesReport.push(projectReport);
        return (commonAmenitiesReport);
    };
    ReportService.prototype.getThumbRuleAndEstimatedReportForProjectCostHead = function (projectCostHead, projectRates, projectReport, thumbRuleReports, estimatedReports, totalArea, rateUnit) {
        for (var _i = 0, projectCostHead_1 = projectCostHead; _i < projectCostHead_1.length; _i++) {
            var costHead = projectCostHead_1[_i];
            if (costHead.active) {
                var thumbRuleReport = new ThumbRuleReport();
                thumbRuleReport.name = costHead.name;
                thumbRuleReport.rateAnalysisId = costHead.rateAnalysisId;
                thumbRuleReport.amount = Math.round(costHead.budgetedCostAmount);
                thumbRuleReport.costHeadActive = costHead.active;
                thumbRuleReport.rate = parseFloat((thumbRuleReport.amount / totalArea).toFixed(2));
                thumbRuleReports.push(thumbRuleReport);
                var estimateReport = new EstimateReport();
                estimateReport = this.getEstimatedReport(projectRates, costHead, totalArea, rateUnit);
                estimatedReports.push(estimateReport);
            }
        }
    };
    ReportService.prototype.getCostHeads = function (url, user, callback) {
        var _this = this;
        logger.info('Report Service, getCostHeads has been hit');
        this.rateAnalysisService.getCostHeads(url, user, function (error, result) {
            if (error) {
                console.log('error : ' + JSON.stringify(error));
                callback(error, null);
            }
            else {
                callback(null, { data: result, access_token: _this.authInterceptor.issueTokenWithUid(user) });
            }
        });
    };
    ReportService.prototype.getWorkItems = function (url, user, callback) {
        var _this = this;
        logger.info('Report Service, getWorkItems has been hit');
        this.rateAnalysisService.getWorkItems(url, user, function (error, result) {
            if (error) {
                console.log('error : ' + JSON.stringify(error));
                callback(error, null);
            }
            else {
                callback(null, { data: result, access_token: _this.authInterceptor.issueTokenWithUid(user) });
            }
        });
    };
    ReportService.prototype.getMaterialDetails = function (projectId, user, callback) {
        var _this = this;
        logger.info('Report Service, getMaterialDetails has been hit');
        var query = { _id: projectId };
        var populate = { path: 'buildings' };
        this.projectRepository.findAndPopulate(query, populate, function (error, result) {
            logger.info('Report Service, findAndPopulate has been hit');
            if (error) {
                callback(error, null);
            }
            else {
                callback(null, _this.getBuildingMaterialDetails(result[0].buildings));
            }
        });
    };
    ReportService.prototype.getBuildingMaterialDetails = function (buildings) {
        var materialTakeOffFlatDetailsArray = new Array();
        var buildingName;
        for (var _i = 0, buildings_2 = buildings; _i < buildings_2.length; _i++) {
            var building = buildings_2[_i];
            buildingName = building.name;
            this.addMaterialDTOForActiveCostHeadInDTOArray(building, buildingName, materialTakeOffFlatDetailsArray);
        }
        return materialTakeOffFlatDetailsArray;
    };
    ReportService.prototype.getMaterialFilters = function (projectId, user, callback) {
        var _this = this;
        logger.info('Report Service, getMaterialFilters has been hit');
        var query = { _id: projectId };
        var populate = { path: 'buildings' };
        this.projectRepository.findAndPopulate(query, populate, function (error, result) {
            logger.info('Report Service, findAndPopulate has been hit');
            if (error) {
                callback(error, null);
            }
            else {
                callback(null, _this.getMaterialTakeOffFilterObject(result[0].buildings));
            }
        });
    };
    ReportService.prototype.getMaterialTakeOffReport = function (projectId, building, elementWiseReport, element, user, callback) {
        var _this = this;
        logger.info('Report Service, getMaterialTakeOffReport has been hit');
        var query = { _id: projectId };
        var populate = { path: 'buildings' };
        this.projectRepository.findAndPopulate(query, populate, function (error, result) {
            logger.info('Report Service, findAndPopulate has been hit');
            if (error) {
                callback(error, null);
            }
            else {
                var materialTakeOffFlatDetailsArray = _this.getBuildingMaterialDetails(result[0].buildings);
                var materialReportRowData = _this.getMaterialDataFromFlatDetailsArray(elementWiseReport, element, building, materialTakeOffFlatDetailsArray);
                var materialTakeOffReport = new MaterialTakeOffReport(null, null);
                materialTakeOffReport.secondaryView = {};
                _this.populateMaterialTakeOffReportFromRowData(materialReportRowData, materialTakeOffReport, building);
                var responseData = {};
                responseData[element] = materialTakeOffReport;
                callback(null, responseData);
            }
        });
    };
    ReportService.prototype.populateMaterialTakeOffReportFromRowData = function (materialReportRowData, materialTakeOffReport, building) {
        for (var _i = 0, materialReportRowData_1 = materialReportRowData; _i < materialReportRowData_1.length; _i++) {
            var record = materialReportRowData_1[_i];
            if (materialTakeOffReport.secondaryView[record.header] !== undefined &&
                materialTakeOffReport.secondaryView[record.header] !== null) {
                var materialTakeOffSecondaryView = materialTakeOffReport.secondaryView[record.header];
                var table = materialTakeOffSecondaryView.table;
                if (table.content[record.rowValue] !== undefined && table.content[record.rowValue] !== null) {
                    var tableViewContent = table.content[record.rowValue];
                    tableViewContent.columnTwo = tableViewContent.columnTwo + record.Total;
                    if (record.subValue) {
                        tableViewContent.subContent[record.subValue] =
                            new MaterialTakeOffTableViewSubContent(record.subValue, record.Total, record.unit);
                    }
                }
                else {
                    var subContentMap = {};
                    if (record.subValue) {
                        var materialTakeOffTableViewSubContent = new MaterialTakeOffTableViewSubContent(record.subValue, record.Total, record.unit);
                        subContentMap[record.subValue] = materialTakeOffTableViewSubContent;
                    }
                    var tableViewContent = new MaterialTakeOffTableViewContent(record.rowValue, record.Total, record.unit, subContentMap);
                    table.content[record.rowValue] = tableViewContent;
                }
                table.footer.columnTwo = table.footer.columnTwo + record.Total;
                materialTakeOffSecondaryView.header = table.footer.columnTwo + ' ' + record.unit;
            }
            else {
                var subContentMap = {};
                if (record.subValue) {
                    var materialTakeOffTableViewSubContent = new MaterialTakeOffTableViewSubContent(record.subValue, record.Total, 'BAG');
                    subContentMap[record.subValue] = materialTakeOffTableViewSubContent;
                }
                var tableViewContent = new MaterialTakeOffTableViewContent(record.rowValue, record.Total, record.unit, subContentMap);
                var tableViewContentMap = {};
                tableViewContentMap[record.rowValue] = tableViewContent;
                var materialTakeOffTableViewHeader = new MaterialTakeOffTableViewHeaders('Item', 'Quantity', 'Unit');
                var materialTakeOffTableViewFooter = new MaterialTakeOffTableViewFooter('Total', record.Total, record.unit);
                var table = new MaterialTakeOffTableView(materialTakeOffTableViewHeader, tableViewContentMap, materialTakeOffTableViewFooter);
                var materialTakeOffSecondaryView = new MaterialTakeOffSecondaryView(materialTakeOffTableViewFooter.columnTwo + ' ' + materialTakeOffTableViewFooter.columnThree, table);
                materialTakeOffReport.header = building;
                materialTakeOffReport.secondaryView[record.header] = materialTakeOffSecondaryView;
            }
        }
    };
    ReportService.prototype.getMaterialDataFromFlatDetailsArray = function (elementWiseReport, element, building, materialTakeOffFlatDetailsArray) {
        var sqlQuery;
        switch (elementWiseReport) {
            case Constants.STR_COSTHEAD:
                sqlQuery = this.alasqlQueryForMaterialTakeOffDataCostHeadWise(building);
                break;
            case Constants.STR_MATERIAL:
                sqlQuery = this.alasqlQueryForMaterialTakeOffDataMaterialWise(building);
                break;
        }
        var materialReportRowData = alasql(sqlQuery, [materialTakeOffFlatDetailsArray, element]);
        return materialReportRowData;
    };
    ReportService.prototype.alasqlQueryForMaterialTakeOffDataMaterialWise = function (building) {
        var select = Constants.STR_EMPTY;
        var from = Constants.ALASQL_FROM;
        var where = Constants.STR_EMPTY;
        var groupBy = Constants.ALASQL_GROUP_BY_MATERIAL_TAKEOFF_MATERIAL_WISE;
        var orderBy = Constants.ALASQL_ORDER_BY_MATERIAL_TAKEOFF_MATERIAL_WISE;
        var sqlQuery;
        if (building !== Constants.STR_ALL_BUILDING) {
            select = Constants.ALASQL_SELECT_MATERIAL_TAKEOFF_MATERIAL_WISE + Constants.STR_COMMA_SPACE +
                Constants.ALASQL_SELECT_QUANTITY_NAME_AS;
            where = Constants.ALASQL_WHERE_MATERIAL_NAME_EQUALS_TO +
                Constants.STR_AND + Constants.ALASQL_SELECT_BUILDING_NAME + building + Constants.STR_DOUBLE_INVERTED_COMMA;
        }
        else {
            select = Constants.ALASQL_SELECT_MATERIAL_TAKEOFF_MATERIAL_WISE;
            where = Constants.ALASQL_WHERE_MATERIAL_NAME_EQUALS_TO;
        }
        sqlQuery = select + from + where + groupBy + orderBy;
        return sqlQuery;
    };
    ReportService.prototype.alasqlQueryForMaterialTakeOffDataCostHeadWise = function (building) {
        var select = Constants.STR_EMPTY;
        var from = Constants.ALASQL_FROM;
        var where = Constants.STR_EMPTY;
        var groupBy = Constants.STR_EMPTY;
        var orderBy = Constants.STR_EMPTY;
        var sqlQuery;
        if (building !== Constants.STR_ALL_BUILDING) {
            select = Constants.ALASQL_SELECT_MATERIAL_TAKEOFF_COSTHEAD_WISE + Constants.STR_COMMA_SPACE +
                Constants.ALASQL_SELECT_QUANTITY_NAME_AS;
            where = Constants.ALASQL_WHERE_COSTHEAD_NAME_EQUALS_TO
                + Constants.STR_AND + Constants.ALASQL_SELECT_BUILDING_NAME + building + Constants.STR_DOUBLE_INVERTED_COMMA;
            groupBy = Constants.ALASQL_GROUP_MATERIAL_WORKITEM_QUANTITY_MATERIAL_TAKEOFF_COSTHEAD_WISE;
            orderBy = Constants.ALASQL_ORDER_BY_MATERIAL_WORKITEM_COSTHEAD_WISE;
        }
        else {
            select = Constants.ALASQL_SELECT_MATERIAL_TAKEOFF_COSTHEAD_WISE_FOR_ALL_BUILDINGS;
            where = Constants.ALASQL_WHERE_COSTHEAD_NAME_EQUALS_TO;
            groupBy = Constants.ALASQL_GROUP_MATERIAL_BUILDING_QUANTITY_MATERIAL_TAKEOFF_COSTHEAD_WISE_FOR_ALL_BUILDINGS;
            orderBy = Constants.ALASQL_ORDER_BY_MATERIAL_BUILDING_MATERIAL_TAKEOFF_COSTHEAD_WISE;
        }
        sqlQuery = select + from + where + groupBy + orderBy;
        return sqlQuery;
    };
    ReportService.prototype.getMaterialTakeOffFilterObject = function (buildings) {
        var materialTakeOffFlatDetailsArray = this.getBuildingMaterialDetails(buildings);
        var column = Constants.STR_BUILDING_NAME;
        var buildingList = this.getDistinctArrayOfStringFromAlasql(column, materialTakeOffFlatDetailsArray);
        column = Constants.STR_COSTHEAD_NAME;
        var costHeadList = this.getDistinctArrayOfStringFromAlasql(column, materialTakeOffFlatDetailsArray);
        column = Constants.STR_Material_NAME;
        var materialList = this.getDistinctArrayOfStringFromAlasql(column, materialTakeOffFlatDetailsArray);
        var materialTakeOffFiltersObject = new MaterialTakeOffFiltersListDTO(buildingList, costHeadList, materialList);
        return materialTakeOffFiltersObject;
    };
    ReportService.prototype.getDistinctArrayOfStringFromAlasql = function (column, materialTakeOffFlatDetailsArray) {
        var sqlQuery = 'SELECT DISTINCT flatData.' + column + ' FROM ? AS flatData';
        var distinctObjectArray = alasql(sqlQuery, [materialTakeOffFlatDetailsArray]);
        var distinctNameStringArray = new Array();
        for (var _i = 0, distinctObjectArray_1 = distinctObjectArray; _i < distinctObjectArray_1.length; _i++) {
            var distinctObject = distinctObjectArray_1[_i];
            distinctNameStringArray.push(distinctObject[column]);
        }
        return distinctNameStringArray;
    };
    ReportService.prototype.addMaterialDTOForActiveCostHeadInDTOArray = function (building, buildingName, materialTakeOffFlatDetailsArray) {
        var costHeadName;
        for (var _i = 0, _a = building.costHeads; _i < _a.length; _i++) {
            var costHead = _a[_i];
            if (costHead.active) {
                costHeadName = costHead.name;
                this.addMaterialDTOForActiveCategoryInDTOArray(costHead, buildingName, costHeadName, materialTakeOffFlatDetailsArray);
            }
        }
    };
    ReportService.prototype.addMaterialDTOForActiveCategoryInDTOArray = function (costHead, buildingName, costHeadName, materialTakeOffFlatDetailsArray) {
        var categoryName;
        for (var _i = 0, _a = costHead.categories; _i < _a.length; _i++) {
            var category = _a[_i];
            if (category.active) {
                categoryName = category.name;
                this.addMaterialDTOForActiveWorkitemInDTOArray(category, buildingName, costHeadName, categoryName, materialTakeOffFlatDetailsArray);
            }
        }
    };
    ReportService.prototype.addMaterialDTOForActiveWorkitemInDTOArray = function (category, buildingName, costHeadName, categoryName, materialTakeOffFlatDetailsArray) {
        var workItemName;
        for (var _i = 0, _a = category.workItems; _i < _a.length; _i++) {
            var workItem = _a[_i];
            if (workItem.active) {
                workItemName = workItem.name;
                this.addEstimatedQuantityAndRateMaterialItemInDTOArray(workItem, buildingName, costHeadName, categoryName, workItemName, materialTakeOffFlatDetailsArray);
            }
        }
    };
    ReportService.prototype.addEstimatedQuantityAndRateMaterialItemInDTOArray = function (workItem, buildingName, costHeadName, categoryName, workItemName, materialTakeOffFlatDetailsArray) {
        var quantityName;
        if (workItem.quantity.isDirectQuantity && workItem.rate.isEstimated) {
            quantityName = Constants.STR_DIRECT;
            this.createAndAddMaterialDTOObjectInDTOArray(workItem, buildingName, costHeadName, categoryName, workItemName, quantityName, materialTakeOffFlatDetailsArray);
        }
        else if (workItem.quantity.isEstimated && workItem.rate.isEstimated) {
            for (var _i = 0, _a = workItem.quantity.quantityItemDetails; _i < _a.length; _i++) {
                var quantity = _a[_i];
                quantityName = quantity.name;
                this.createAndAddMaterialDTOObjectInDTOArray(workItem, buildingName, costHeadName, categoryName, workItemName, quantityName, materialTakeOffFlatDetailsArray);
            }
        }
    };
    ReportService.prototype.createAndAddMaterialDTOObjectInDTOArray = function (workItem, buildingName, costHeadName, categoryName, workItemName, quantityName, materialTakeOffFlatDetailsArray) {
        for (var _i = 0, _a = workItem.rate.rateItems; _i < _a.length; _i++) {
            var rateItem = _a[_i];
            var materialTakeOffFlatDetailDTO = new MaterialTakeOffFlatDetailsDTO(buildingName, costHeadName, categoryName, workItemName, rateItem.itemName, quantityName, ((workItem.quantity.total / workItem.rate.quantity) * rateItem.quantity), rateItem.unit);
            materialTakeOffFlatDetailsArray.push(materialTakeOffFlatDetailDTO);
        }
    };
    return ReportService;
}());
Object.seal(ReportService);
module.exports = ReportService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9hcHBsaWNhdGlvblByb2plY3Qvc2VydmljZXMvUmVwb3J0U2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsOEVBQWlGO0FBQ2pGLGdGQUFtRjtBQUNuRixvRUFBdUU7QUFDdkUsa0VBQXFFO0FBR3JFLG1GQUFzRjtBQUN0RixxRkFBd0Y7QUFDeEYsOEVBQWlGO0FBRWpGLG1GQUFzRjtBQUN0RixpRkFBb0Y7QUFDcEYsMEVBQTZFO0FBQzdFLHdFQUEyRTtBQUMzRSwyREFBOEQ7QUFFOUQsK0JBQWtDO0FBQ2xDLCtDQUFrRDtBQUNsRCxpREFBb0Q7QUFLcEQsc0dBQXlHO0FBQ3pHLHNHQUF5RztBQUV6RyxpR0FBb0c7QUFDcEcsdUdBQTBHO0FBQzFHLCtHQUFrSDtBQUNsSCxxSEFBd0g7QUFDeEgsMkhBQThIO0FBQzlILHFIQUF3SDtBQUN4SCxtSEFBc0g7QUFDdEgsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQy9CLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUMvQixJQUFJLE1BQU0sR0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFFOUM7SUFVRTtRQUNFLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLGlCQUFpQixFQUFFLENBQUM7UUFDakQsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksa0JBQWtCLEVBQUUsQ0FBQztRQUNuRCxJQUFJLENBQUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxRQUFRLENBQUM7UUFDdEMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQzdDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQUNyQyxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxtQkFBbUIsRUFBRSxDQUFDO0lBQ3ZELENBQUM7SUFFRCxpQ0FBUyxHQUFULFVBQVcsU0FBZSxFQUFF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QUFJLENBQUMsU0FBUyxFQUF2QixjQUF1QixFQUF2QixJQUF1QjtZQUF2QyxJQUFJLFFBQVEsU0FBQTtZQUNmLElBQUksNEJBQTRCLEdBQUcsSUFBSSw2QkFBNkIsQ0FBQyxZQUFZLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFDM0csWUFBWSxFQUFFLFFBQVEsQ0FBQyxRQUFRLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFDdkgsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2pCLCtCQUErQixDQUFDLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1NBQ3BFO0lBQ0gsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0E5ZkEsQUE4ZkMsSUFBQTtBQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDM0IsaUJBQVMsYUFBYSxDQUFDIiwiZmlsZSI6ImFwcC9hcHBsaWNhdGlvblByb2plY3Qvc2VydmljZXMvUmVwb3J0U2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQcm9qZWN0UmVwb3NpdG9yeSA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvcmVwb3NpdG9yeS9Qcm9qZWN0UmVwb3NpdG9yeScpO1xyXG5pbXBvcnQgQnVpbGRpbmdSZXBvc2l0b3J5ID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9yZXBvc2l0b3J5L0J1aWxkaW5nUmVwb3NpdG9yeScpO1xyXG5pbXBvcnQgVXNlclNlcnZpY2UgPSByZXF1aXJlKCcuLy4uLy4uL2ZyYW1ld29yay9zZXJ2aWNlcy9Vc2VyU2VydmljZScpO1xyXG5pbXBvcnQgUHJvamVjdEFzc2V0ID0gcmVxdWlyZSgnLi4vLi4vZnJhbWV3b3JrL3NoYXJlZC9wcm9qZWN0YXNzZXQnKTtcclxuaW1wb3J0IFVzZXIgPSByZXF1aXJlKCcuLi8uLi9mcmFtZXdvcmsvZGF0YWFjY2Vzcy9tb25nb29zZS91c2VyJyk7XHJcbmltcG9ydCBCdWlsZGluZyA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9uZ29vc2UvQnVpbGRpbmcnKTtcclxuaW1wb3J0IEJ1aWxkaW5nUmVwb3J0ID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L3JlcG9ydHMvQnVpbGRpbmdSZXBvcnQnKTtcclxuaW1wb3J0IFRodW1iUnVsZVJlcG9ydCA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9yZXBvcnRzL1RodW1iUnVsZVJlcG9ydCcpO1xyXG5pbXBvcnQgQXV0aEludGVyY2VwdG9yID0gcmVxdWlyZSgnLi4vLi4vZnJhbWV3b3JrL2ludGVyY2VwdG9yL2F1dGguaW50ZXJjZXB0b3InKTtcclxuaW1wb3J0IENvc3RIZWFkID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9tb25nb29zZS9Db3N0SGVhZCcpO1xyXG5pbXBvcnQgRXN0aW1hdGVSZXBvcnQgPSByZXF1aXJlKCcuLi9kYXRhYWNjZXNzL21vZGVsL3Byb2plY3QvcmVwb3J0cy9Fc3RpbWF0ZVJlcG9ydCcpO1xyXG5pbXBvcnQgUHJvamVjdFJlcG9ydCA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9yZXBvcnRzL1Byb2plY3RSZXBvcnQnKTtcclxuaW1wb3J0IFRodW1iUnVsZSA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9idWlsZGluZy9UaHVtYlJ1bGUnKTtcclxuaW1wb3J0IEVzdGltYXRlID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L2J1aWxkaW5nL0VzdGltYXRlJyk7XHJcbmltcG9ydCBSYXRlQW5hbHlzaXNTZXJ2aWNlID0gcmVxdWlyZSgnLi9SYXRlQW5hbHlzaXNTZXJ2aWNlJyk7XHJcbmltcG9ydCBDYXRlZ29yeSA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9idWlsZGluZy9DYXRlZ29yeScpO1xyXG5pbXBvcnQgYWxhc3FsID0gcmVxdWlyZSgnYWxhc3FsJyk7XHJcbmltcG9ydCBDb25zdGFudHMgPSByZXF1aXJlKCcuLi9zaGFyZWQvY29uc3RhbnRzJyk7XHJcbmltcG9ydCBQcm9qZWN0U2VydmljZSA9IHJlcXVpcmUoJy4vUHJvamVjdFNlcnZpY2UnKTtcclxuaW1wb3J0IENlbnRyYWxpemVkUmF0ZSA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9DZW50cmFsaXplZFJhdGUnKTtcclxuaW1wb3J0IE1hdGVyaWFsRGV0YWlsRFRPID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9kdG8vcHJvamVjdC9NYXRlcmlhbERldGFpbERUTycpO1xyXG5pbXBvcnQgV29ya0l0ZW0gPSByZXF1aXJlKCcuLi9kYXRhYWNjZXNzL21vZGVsL3Byb2plY3QvYnVpbGRpbmcvV29ya0l0ZW0nKTtcclxuaW1wb3J0IHtRdWFudGl0eURldGFpbHN9IGZyb20gJy4uLy4uLy4uLy4uL2NsaWVudC9hcHAvYnVpbGQtaW5mby9mcmFtZXdvcmsvbW9kZWwvcXVhbnRpdHktZGV0YWlscyc7XHJcbmltcG9ydCBNYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0RUTyA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvZHRvL1JlcG9ydC9NYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0RUTycpO1xyXG5pbXBvcnQgTWF0ZXJpYWxUYWtlT2ZmRmlsdGVyc0xpc3REVE8gPSByZXF1aXJlKCcuLi9kYXRhYWNjZXNzL2R0by9SZXBvcnQvTWF0ZXJpYWxUYWtlT2ZmRmlsdGVyc0xpc3REVE8nKTtcclxuaW1wb3J0IHtlbGVtZW50fSBmcm9tICdwcm90cmFjdG9yJztcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlJlcG9ydCA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9yZXBvcnRzL01hdGVyaWFsVGFrZU9mZlJlcG9ydCcpO1xyXG5pbXBvcnQgTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3ID0gcmVxdWlyZShcIi4uL2RhdGFhY2Nlc3MvbW9kZWwvcHJvamVjdC9yZXBvcnRzL01hdGVyaWFsVGFrZU9mZlRhYmxlVmlld1wiKTtcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlNlY29uZGFyeVZpZXcgPSByZXF1aXJlKFwiLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L3JlcG9ydHMvTWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5Vmlld1wiKTtcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0NvbnRlbnQgPSByZXF1aXJlKFwiLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L3JlcG9ydHMvTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Q29udGVudFwiKTtcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld1N1YkNvbnRlbnQgPSByZXF1aXJlKFwiLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L3JlcG9ydHMvTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3U3ViQ29udGVudFwiKTtcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0hlYWRlcnMgPSByZXF1aXJlKFwiLi4vZGF0YWFjY2Vzcy9tb2RlbC9wcm9qZWN0L3JlcG9ydHMvTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3SGVhZGVyc1wiKTtcclxuaW1wb3J0IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0Zvb3RlciA9IHJlcXVpcmUoXCIuLi9kYXRhYWNjZXNzL21vZGVsL3Byb2plY3QvcmVwb3J0cy9NYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdGb290ZXJcIik7XHJcbmxldCBjb25maWcgPSByZXF1aXJlKCdjb25maWcnKTtcclxudmFyIGxvZzRqcyA9IHJlcXVpcmUoJ2xvZzRqcycpO1xyXG52YXIgbG9nZ2VyPWxvZzRqcy5nZXRMb2dnZXIoJ1JlcG9ydCBTZXJ2aWNlJyk7XHJcblxyXG5jbGFzcyBSZXBvcnRTZXJ2aWNlIHtcclxuICBBUFBfTkFNRTogc3RyaW5nO1xyXG4gIGNvbXBhbnlfbmFtZTogc3RyaW5nO1xyXG4gIHByaXZhdGUgcHJvamVjdFJlcG9zaXRvcnk6IFByb2plY3RSZXBvc2l0b3J5O1xyXG4gIHByaXZhdGUgYnVpbGRpbmdSZXBvc2l0b3J5OiBCdWlsZGluZ1JlcG9zaXRvcnk7XHJcbiAgcHJpdmF0ZSBhdXRoSW50ZXJjZXB0b3I6IEF1dGhJbnRlcmNlcHRvcjtcclxuICBwcml2YXRlIHVzZXJTZXJ2aWNlIDogVXNlclNlcnZpY2U7XHJcbiAgcHJpdmF0ZSByYXRlQW5hbHlzaXNTZXJ2aWNlIDogUmF0ZUFuYWx5c2lzU2VydmljZTtcclxuICBwcml2YXRlIHByb2plY3RTZXJ2aWNlIDogUHJvamVjdFNlcnZpY2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5wcm9qZWN0UmVwb3NpdG9yeSA9IG5ldyBQcm9qZWN0UmVwb3NpdG9yeSgpO1xyXG4gICAgdGhpcy5idWlsZGluZ1JlcG9zaXRvcnkgPSBuZXcgQnVpbGRpbmdSZXBvc2l0b3J5KCk7XHJcbiAgICB0aGlzLkFQUF9OQU1FID0gUHJvamVjdEFzc2V0LkFQUF9OQU1FO1xyXG4gICAgdGhpcy5hdXRoSW50ZXJjZXB0b3IgPSBuZXcgQXV0aEludGVyY2VwdG9yKCk7XHJcbiAgICB0aGlzLnVzZXJTZXJ2aWNlID0gbmV3IFVzZXJTZXJ2aWNlKCk7XHJcbiAgICB0aGlzLnJhdGVBbmFseXNpc1NlcnZpY2UgPSBuZXcgUmF0ZUFuYWx5c2lzU2VydmljZSgpO1xyXG4gIH1cclxuXHJcbiAgZ2V0UmVwb3J0KCBwcm9qZWN0SWQgOiBhbnksIHJlcG9ydFR5cGUgOiBzdHJpbmcsIHJhdGVVbml0IDogc3RyaW5nLCBhcmVhVHlwZSA6IHN0cmluZyzigILigIJ1c2VyOiBVc2VyLFxyXG4gICAgICAgICAgICAgY2FsbGJhY2s6IChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4gdm9pZCkge1xyXG5cclxuICAgIGxvZ2dlci5pbmZvKCdSZXBvcnQgU2VydmljZSwgZ2V0UmVwb3J0IGhhcyBiZWVuIGhpdCcpO1xyXG4gICAgbGV0IHF1ZXJ5ID0geyBfaWQ6IHByb2plY3RJZH07XHJcbiAgICBsZXQgcG9wdWxhdGUgPSB7cGF0aCA6ICdidWlsZGluZ3MnfTtcclxuICAgIHRoaXMucHJvamVjdFJlcG9zaXRvcnkuZmluZEFuZFBvcHVsYXRlKHF1ZXJ5LCBwb3B1bGF0ZSwgKGVycm9yLCByZXN1bHQpID0+IHtcclxuICAgICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBmaW5kQW5kUG9wdWxhdGUgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICAgIGlmKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBidWlsZGluZ3MgPSByZXN1bHRbMF0uYnVpbGRpbmdzO1xyXG4gICAgICAgIHZhciB0eXBlT2ZBcmVhOiBzdHJpbmc7XHJcbiAgICAgICAgbGV0IHRvdGFsQXJlYTogbnVtYmVyO1xyXG4gICAgICAgIGxldCBjaG9pY2UgPSBhcmVhVHlwZTtcclxuICAgICAgICBzd2l0Y2ggKGNob2ljZSkge1xyXG4gICAgICAgICAgY2FzZSBDb25zdGFudHMuU0xBQl9BUkVBOlxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0eXBlT2ZBcmVhID0gQ29uc3RhbnRzLlRPVEFMX1NMQUJfQVJFQTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY2FzZSBDb25zdGFudHMuU0FMRUFCTEVfQVJFQTpcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgdHlwZU9mQXJlYSA9IENvbnN0YW50cy5UT1RBTF9TQUxFQUJMRV9BUkVBO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBjYXNlICBDb25zdGFudHMuQ0FSUEVUX0FSRUEgOlxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0eXBlT2ZBcmVhID0gQ29uc3RhbnRzLlRPVEFMX0NBUlBFVF9BUkVBO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGRlZmF1bHQgOiAgY2FsbGJhY2soZXJyb3IsbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICBsZXQgdG90YWxPZkFyZWEgPSBhbGFzcWwoJ1ZBTFVFIE9GIFNFTEVDVCBST1VORChTVU0oJyt0eXBlT2ZBcmVhKycpLDIpIEZST00gPycsW2J1aWxkaW5nc10pO1xyXG4gICAgICAgIGlmKHJhdGVVbml0ID09PSBDb25zdGFudHMuU1FVUkVNRVRFUl9VTklUKSB7XHJcbiAgICAgICAgIHRvdGFsQXJlYSA9IE1hdGgucm91bmQodG90YWxPZkFyZWEgKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdG90YWxBcmVhID0gdG90YWxPZkFyZWE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBwcm9qZWN0UmVwb3J0IDogUHJvamVjdFJlcG9ydCA9IG5ldyBQcm9qZWN0UmVwb3J0KCk7XHJcblxyXG4gICAgICAgIHByb2plY3RSZXBvcnQuYnVpbGRpbmdzID0gdGhpcy5nZW5lcmF0ZVJlcG9ydEJ5Q29zdEhlYWRzKGJ1aWxkaW5ncywgdHlwZU9mQXJlYSwgcmF0ZVVuaXQpO1xyXG5cclxuICAgICAgICBsZXQgcHJvamVjdENvc3RIZWFkcyA9IHJlc3VsdFswXS5wcm9qZWN0Q29zdEhlYWRzO1xyXG4gICAgICAgIGxldCBwcm9qZWN0UmF0ZXMgPSByZXN1bHRbMF0ucmF0ZXM7XHJcbiAgICAgICAgaWYocHJvamVjdENvc3RIZWFkcyE9PSBudWxsKSB7XHJcbiAgICAgICAgICBwcm9qZWN0UmVwb3J0LmNvbW1vbkFtZW5pdGllcyA9IHRoaXMuZ2VuZXJhdGVSZXBvcnRGb3JQcm9qZWN0Q29zdEhlYWRzKHByb2plY3RDb3N0SGVhZHMsIHByb2plY3RSYXRlcywgdG90YWxBcmVhLCByYXRlVW5pdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYWxsYmFjayhudWxsLHsgZGF0YTogcHJvamVjdFJlcG9ydCwgYWNjZXNzX3Rva2VuOiB0aGlzLmF1dGhJbnRlcmNlcHRvci5pc3N1ZVRva2VuV2l0aFVpZCh1c2VyKX0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlUmVwb3J0QnlDb3N0SGVhZHMoIGJ1aWxkaW5nczogIEFycmF5PEJ1aWxkaW5nPiAsIHR5cGVPZkFyZWE6IHN0cmluZywgcmF0ZVVuaXQ6IHN0cmluZykge1xyXG5cclxuICAgIGxldCBidWlsZGluZ3NSZXBvcnQgOiBBcnJheTxCdWlsZGluZ1JlcG9ydD4gPSBuZXcgQXJyYXk8QnVpbGRpbmdSZXBvcnQ+KCk7XHJcbiAgICBmb3IgKGxldCBidWlsZGluZyBvZiBidWlsZGluZ3MpIHtcclxuICAgICAgbGV0IGJ1aWxkaW5nUmVwb3J0ID0gbmV3IEJ1aWxkaW5nUmVwb3J0O1xyXG4gICAgICBidWlsZGluZ1JlcG9ydC5uYW1lID0gYnVpbGRpbmcubmFtZTtcclxuICAgICAgYnVpbGRpbmdSZXBvcnQuX2lkID0gYnVpbGRpbmcuX2lkO1xyXG4gICAgICBpZihyYXRlVW5pdCA9PT0gQ29uc3RhbnRzLlNRVVJFTUVURVJfVU5JVCkge1xyXG4gICAgICAgIGJ1aWxkaW5nUmVwb3J0LmFyZWEgPSAgTWF0aC5yb3VuZCggYnVpbGRpbmdbdHlwZU9mQXJlYV0gKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBidWlsZGluZ1JlcG9ydC5hcmVhID0gYnVpbGRpbmdbdHlwZU9mQXJlYV07XHJcbiAgICAgIH1cclxuICAgICAgbGV0IHRodW1iUnVsZSAgPSBuZXcgVGh1bWJSdWxlKCk7XHJcbiAgICAgIGxldCBlc3RpbWF0ZSAgPSBuZXcgRXN0aW1hdGUoKTtcclxuICAgICAgbGV0IHRodW1iUnVsZVJlcG9ydHMgPSBuZXcgQXJyYXk8VGh1bWJSdWxlUmVwb3J0PigpO1xyXG4gICAgICBsZXQgZXN0aW1hdGVkUmVwb3J0cyA9IG5ldyBBcnJheTxFc3RpbWF0ZVJlcG9ydD4oKTtcclxuXHJcblxyXG4gICAgICB0aGlzLmdldFRodW1iUnVsZUFuZEVzdGltYXRlZFJlcG9ydChidWlsZGluZywgYnVpbGRpbmdSZXBvcnQsIHRodW1iUnVsZVJlcG9ydHMsIGVzdGltYXRlZFJlcG9ydHMsIHJhdGVVbml0KTtcclxuXHJcbiAgICAgIGxldCB0b3RhbFJhdGVzID0gYWxhc3FsKCdTRUxFQ1QgUk9VTkQoU1VNKGFtb3VudCksMikgQVMgdG90YWxBbW91bnQsIFJPVU5EKFNVTShyYXRlKSwyKSBBUyB0b3RhbFJhdGUgRlJPTSA/JyxbdGh1bWJSdWxlUmVwb3J0c10pO1xyXG4gICAgICB0aHVtYlJ1bGUudG90YWxSYXRlID0gdG90YWxSYXRlc1swXS50b3RhbFJhdGU7XHJcbiAgICAvKiAgaWYocmF0ZVVuaXQgPT09IENvbnN0YW50cy5TUVVSRU1FVEVSX1VOSVQpIHtcclxuICAgICAgICB0aHVtYlJ1bGUudG90YWxSYXRlID0gIHBhcnNlRmxvYXQoKHRodW1iUnVsZS50b3RhbFJhdGUgKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKS50b0ZpeGVkKDIpKTtcclxuICAgICAgfSovXHJcbiAgICAgIHRodW1iUnVsZS50b3RhbEJ1ZGdldGVkQ29zdCA9IE1hdGgucm91bmQodG90YWxSYXRlc1swXS50b3RhbEFtb3VudCk7XHJcbiAgICAgIHRodW1iUnVsZS50aHVtYlJ1bGVSZXBvcnRzID0gdGh1bWJSdWxlUmVwb3J0cztcclxuXHJcbiAgICAgIGxldCB0b3RhbEVzdGltYXRlZFJhdGVzID0gYWxhc3FsKCdTRUxFQ1QgUk9VTkQoU1VNKHRvdGFsKSwyKSBBUyB0b3RhbEFtb3VudCwgUk9VTkQoU1VNKHJhdGUpLDIpIEFTIHRvdGFsUmF0ZSBGUk9NID8nLFtlc3RpbWF0ZWRSZXBvcnRzXSk7XHJcbiAgICAgIGVzdGltYXRlLnRvdGFsUmF0ZSA9IHRvdGFsRXN0aW1hdGVkUmF0ZXNbMF0udG90YWxSYXRlO1xyXG4gICAgLyogIGlmKHJhdGVVbml0ID09PSBDb25zdGFudHMuU1FVUkVNRVRFUl9VTklUKSB7XHJcbiAgICAgICAgZXN0aW1hdGUudG90YWxSYXRlID0gIHBhcnNlRmxvYXQoKGVzdGltYXRlLnRvdGFsUmF0ZSAqIGNvbmZpZy5nZXQoQ29uc3RhbnRzLlNRVUFSRV9NRVRFUikpLnRvRml4ZWQoMikpO1xyXG4gICAgICB9Ki9cclxuICAgICAgZXN0aW1hdGUudG90YWxFc3RpbWF0ZWRDb3N0ID0gTWF0aC5yb3VuZCh0b3RhbEVzdGltYXRlZFJhdGVzWzBdLnRvdGFsQW1vdW50KTtcclxuICAgICAgZXN0aW1hdGUuZXN0aW1hdGVkQ29zdHMgPSBlc3RpbWF0ZWRSZXBvcnRzO1xyXG5cclxuICAgICAgYnVpbGRpbmdSZXBvcnQudGh1bWJSdWxlID0gdGh1bWJSdWxlO1xyXG4gICAgICBidWlsZGluZ1JlcG9ydC5lc3RpbWF0ZSA9IGVzdGltYXRlO1xyXG4gICAgICBidWlsZGluZ3NSZXBvcnQucHVzaChidWlsZGluZ1JlcG9ydCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4oYnVpbGRpbmdzUmVwb3J0KTtcclxuICB9XHJcblxyXG5cclxuICBnZXRUaHVtYlJ1bGVBbmRFc3RpbWF0ZWRSZXBvcnQoYnVpbGRpbmcgOkJ1aWxkaW5nLCBidWlsZGluZ1JlcG9ydDogQnVpbGRpbmdSZXBvcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1iUnVsZVJlcG9ydHM6IFRodW1iUnVsZVJlcG9ydFtdLCBlc3RpbWF0ZWRSZXBvcnRzOiBFc3RpbWF0ZVJlcG9ydFtdLCByYXRlVW5pdDpzdHJpbmcpIHtcclxuXHJcbiAgICBmb3IgKGxldCBjb3N0SGVhZCBvZiBidWlsZGluZy5jb3N0SGVhZHMpIHtcclxuXHJcbiAgICAgIGlmKGNvc3RIZWFkLmFjdGl2ZSkge1xyXG4gICAgICAgIC8vVGh1bWJSdWxlIFJlcG9ydFxyXG4gICAgICAgIGxldCB0aHVtYlJ1bGVSZXBvcnQgPSBuZXcgVGh1bWJSdWxlUmVwb3J0KCk7XHJcbiAgICAgICAgdGh1bWJSdWxlUmVwb3J0Lm5hbWUgPSBjb3N0SGVhZC5uYW1lO1xyXG4gICAgICAgIHRodW1iUnVsZVJlcG9ydC5yYXRlQW5hbHlzaXNJZCA9IGNvc3RIZWFkLnJhdGVBbmFseXNpc0lkO1xyXG4gICAgICAgIHRodW1iUnVsZVJlcG9ydC5hbW91bnQgPSBNYXRoLnJvdW5kKGNvc3RIZWFkLmJ1ZGdldGVkQ29zdEFtb3VudCk7XHJcbiAgICAgICAgdGh1bWJSdWxlUmVwb3J0LmNvc3RIZWFkQWN0aXZlID0gY29zdEhlYWQuYWN0aXZlO1xyXG4gICAgICAgIHRodW1iUnVsZVJlcG9ydC5yYXRlID0gcGFyc2VGbG9hdCgodGh1bWJSdWxlUmVwb3J0LmFtb3VudCAvIGJ1aWxkaW5nUmVwb3J0LmFyZWEpLnRvRml4ZWQoMikpO1xyXG4gICAvKiAgICAgaWYocmF0ZVVuaXQgPT09IENvbnN0YW50cy5TUVVSRU1FVEVSX1VOSVQpIHtcclxuICAgICAgICAgIHRodW1iUnVsZVJlcG9ydC5yYXRlID0gcGFyc2VGbG9hdCgodGh1bWJSdWxlUmVwb3J0LnJhdGUgKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKS50b0ZpeGVkKDIpKTtcclxuICAgICAgICB9Ki9cclxuICAgICAgICB0aHVtYlJ1bGVSZXBvcnRzLnB1c2godGh1bWJSdWxlUmVwb3J0KTtcclxuXHJcbiAgICAgICAgLy9Fc3RpbWF0ZWQgY29zdCBSZXBvcnRcclxuICAgICAgICBsZXQgZXN0aW1hdGVSZXBvcnQgPSBuZXcgRXN0aW1hdGVSZXBvcnQoKTtcclxuICAgICAgICBlc3RpbWF0ZVJlcG9ydCA9IHRoaXMuZ2V0RXN0aW1hdGVkUmVwb3J0KGJ1aWxkaW5nLnJhdGVzLCBjb3N0SGVhZCwgYnVpbGRpbmdSZXBvcnQuYXJlYSwgcmF0ZVVuaXQpO1xyXG4gICAgICAgIGVzdGltYXRlZFJlcG9ydHMucHVzaChlc3RpbWF0ZVJlcG9ydCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldEVzdGltYXRlZFJlcG9ydChjZW50cmFsaXplZFJhdGVzOkFycmF5PENlbnRyYWxpemVkUmF0ZT4sIGNvc3RIZWFkOiBhbnksIGFyZWE6bnVtYmVyLCByYXRlVW5pdDpzdHJpbmcpIHtcclxuXHJcbiAgICBsZXQgZXN0aW1hdGVSZXBvcnQgPSBuZXcgRXN0aW1hdGVSZXBvcnQoKTtcclxuICAgIGVzdGltYXRlUmVwb3J0Lm5hbWUgPSBjb3N0SGVhZC5uYW1lO1xyXG4gICAgZXN0aW1hdGVSZXBvcnQucmF0ZUFuYWx5c2lzSWQgPSBjb3N0SGVhZC5yYXRlQW5hbHlzaXNJZDtcclxuXHJcbiAgICBsZXQgY29zdEhlYWRDYXRlZ29yaWVzOiBBcnJheTxDYXRlZ29yeT4gPSBjb3N0SGVhZC5jYXRlZ29yaWVzO1xyXG4gICAgbGV0IHByb2plY3RTZXJ2aWNlIDogUHJvamVjdFNlcnZpY2UgPSBuZXcgUHJvamVjdFNlcnZpY2UoKTtcclxuICAgIGxldCBjYXRlZ29yaWVzT2JqID0gcHJvamVjdFNlcnZpY2UuZ2V0Q2F0ZWdvcmllc0xpc3RXaXRoQ2VudHJhbGl6ZWRSYXRlcyhjb3N0SGVhZENhdGVnb3JpZXMsIGNlbnRyYWxpemVkUmF0ZXMpO1xyXG4gICAgZXN0aW1hdGVSZXBvcnQudG90YWwgPSBjYXRlZ29yaWVzT2JqLmNhdGVnb3JpZXNBbW91bnQ7XHJcbiAgICBlc3RpbWF0ZVJlcG9ydC5yYXRlID0gcGFyc2VGbG9hdCgoZXN0aW1hdGVSZXBvcnQudG90YWwgLyBhcmVhKS50b0ZpeGVkKDIpKTtcclxuICAgLyogaWYocmF0ZVVuaXQgPT09IENvbnN0YW50cy5TUVVSRU1FVEVSX1VOSVQpIHtcclxuICAgICAgZXN0aW1hdGVSZXBvcnQucmF0ZSA9IHBhcnNlRmxvYXQoKGVzdGltYXRlUmVwb3J0LnJhdGUgKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKS50b0ZpeGVkKDIpKTtcclxuICAgIH0qL1xyXG4gICAgcmV0dXJuIGVzdGltYXRlUmVwb3J0O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVSZXBvcnRGb3JQcm9qZWN0Q29zdEhlYWRzKHByb2plY3RDb3N0SGVhZHM6ICBBcnJheTxDb3N0SGVhZD4sIHByb2plY3RSYXRlczogQXJyYXk8Q2VudHJhbGl6ZWRSYXRlPiwgdG90YWxBcmVhOiBudW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXRlVW5pdDogc3RyaW5nKSB7XHJcbiAgICBsZXQgY29tbW9uQW1lbml0aWVzUmVwb3J0IDogQXJyYXk8QnVpbGRpbmdSZXBvcnQ+ID0gbmV3IEFycmF5PEJ1aWxkaW5nUmVwb3J0PigpO1xyXG4gICAgICBsZXQgcHJvamVjdFJlcG9ydCA9IG5ldyBCdWlsZGluZ1JlcG9ydDtcclxuICAgICAgcHJvamVjdFJlcG9ydC5uYW1lID0gQ29uc3RhbnRzLkFNRU5JVElFUztcclxuICAgICAgcHJvamVjdFJlcG9ydC5hcmVhID0gdG90YWxBcmVhO1xyXG5cclxuICAgICAgbGV0IHRodW1iUnVsZSAgPSBuZXcgVGh1bWJSdWxlKCk7XHJcbiAgICAgIGxldCBlc3RpbWF0ZSAgPSBuZXcgRXN0aW1hdGUoKTtcclxuICAgICAgbGV0IHRodW1iUnVsZVJlcG9ydHMgPSBuZXcgQXJyYXk8VGh1bWJSdWxlUmVwb3J0PigpO1xyXG4gICAgICBsZXQgZXN0aW1hdGVkUmVwb3J0cyA9IG5ldyBBcnJheTxFc3RpbWF0ZVJlcG9ydD4oKTtcclxuXHJcblxyXG4gICAgICB0aGlzLmdldFRodW1iUnVsZUFuZEVzdGltYXRlZFJlcG9ydEZvclByb2plY3RDb3N0SGVhZChwcm9qZWN0Q29zdEhlYWRzLCBwcm9qZWN0UmF0ZXMsXHJcbiAgICAgICAgcHJvamVjdFJlcG9ydCwgdGh1bWJSdWxlUmVwb3J0cywgZXN0aW1hdGVkUmVwb3J0cywgdG90YWxBcmVhLCByYXRlVW5pdCk7XHJcblxyXG4gICAgbGV0IHRvdGFsUmF0ZXMgPSBhbGFzcWwoJ1NFTEVDVCBST1VORChTVU0oYW1vdW50KSwyKSBBUyB0b3RhbEFtb3VudCwgUk9VTkQoU1VNKHJhdGUpLDIpIEFTIHRvdGFsUmF0ZSBGUk9NID8nLFt0aHVtYlJ1bGVSZXBvcnRzXSk7XHJcbiAgICAgIHRodW1iUnVsZS50b3RhbFJhdGUgPSB0b3RhbFJhdGVzWzBdLnRvdGFsUmF0ZTtcclxuICAgICAvKiBpZihyYXRlVW5pdCA9PT0gQ29uc3RhbnRzLlNRVVJFTUVURVJfVU5JVCkge1xyXG4gICAgICAgIHRodW1iUnVsZS50b3RhbFJhdGUgPSAgcGFyc2VGbG9hdCgodGh1bWJSdWxlLnRvdGFsUmF0ZSAqIGNvbmZpZy5nZXQoQ29uc3RhbnRzLlNRVUFSRV9NRVRFUikpLnRvRml4ZWQoMikpO1xyXG4gICAgICB9Ki9cclxuICAgICAgdGh1bWJSdWxlLnRvdGFsQnVkZ2V0ZWRDb3N0ID0gTWF0aC5yb3VuZCh0b3RhbFJhdGVzWzBdLnRvdGFsQW1vdW50KTtcclxuICAgICAgdGh1bWJSdWxlLnRodW1iUnVsZVJlcG9ydHMgPSB0aHVtYlJ1bGVSZXBvcnRzO1xyXG5cclxuICAgIGxldCB0b3RhbEVzdGltYXRlZFJhdGVzID0gYWxhc3FsKCdTRUxFQ1QgUk9VTkQoU1VNKHRvdGFsKSwyKSBBUyB0b3RhbEFtb3VudCwgUk9VTkQoU1VNKHJhdGUpLDIpIEFTIHRvdGFsUmF0ZSBGUk9NID8nLFtlc3RpbWF0ZWRSZXBvcnRzXSk7XHJcbiAgICAgIGVzdGltYXRlLnRvdGFsUmF0ZSA9IHRvdGFsRXN0aW1hdGVkUmF0ZXNbMF0udG90YWxSYXRlO1xyXG4gICAgIC8qIGlmKHJhdGVVbml0ID09PSBDb25zdGFudHMuU1FVUkVNRVRFUl9VTklUKSB7XHJcbiAgICAgICAgZXN0aW1hdGUudG90YWxSYXRlID0gIHBhcnNlRmxvYXQoKGVzdGltYXRlLnRvdGFsUmF0ZSAqIGNvbmZpZy5nZXQoQ29uc3RhbnRzLlNRVUFSRV9NRVRFUikpLnRvRml4ZWQoMikpO1xyXG4gICAgICB9Ki9cclxuICAgICAgZXN0aW1hdGUudG90YWxFc3RpbWF0ZWRDb3N0ID0gIE1hdGgucm91bmQodG90YWxFc3RpbWF0ZWRSYXRlc1swXS50b3RhbEFtb3VudCk7XHJcbiAgICAgIGVzdGltYXRlLmVzdGltYXRlZENvc3RzID0gZXN0aW1hdGVkUmVwb3J0cztcclxuXHJcbiAgICAgIHByb2plY3RSZXBvcnQudGh1bWJSdWxlID0gdGh1bWJSdWxlO1xyXG4gICAgICBwcm9qZWN0UmVwb3J0LmVzdGltYXRlID0gZXN0aW1hdGU7XHJcbiAgICBjb21tb25BbWVuaXRpZXNSZXBvcnQucHVzaChwcm9qZWN0UmVwb3J0KTtcclxuICAgIHJldHVybihjb21tb25BbWVuaXRpZXNSZXBvcnQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VGh1bWJSdWxlQW5kRXN0aW1hdGVkUmVwb3J0Rm9yUHJvamVjdENvc3RIZWFkKHByb2plY3RDb3N0SGVhZDogQXJyYXk8Q29zdEhlYWQ+LCBwcm9qZWN0UmF0ZXM6IEFycmF5PENlbnRyYWxpemVkUmF0ZT4sIHByb2plY3RSZXBvcnQ6IEJ1aWxkaW5nUmVwb3J0LCB0aHVtYlJ1bGVSZXBvcnRzOiBUaHVtYlJ1bGVSZXBvcnRbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkUmVwb3J0czogRXN0aW1hdGVSZXBvcnRbXSwgdG90YWxBcmVhOm51bWJlciwgcmF0ZVVuaXQ6c3RyaW5nKSB7XHJcbiAgZm9yIChsZXQgY29zdEhlYWQgIG9mIHByb2plY3RDb3N0SGVhZCkge1xyXG4gICAgaWYgKGNvc3RIZWFkLmFjdGl2ZSkge1xyXG4gICAgICAvL1RodW1iUnVsZSBSZXBvcnRcclxuICAgICAgbGV0IHRodW1iUnVsZVJlcG9ydCA9IG5ldyBUaHVtYlJ1bGVSZXBvcnQoKTtcclxuICAgICAgdGh1bWJSdWxlUmVwb3J0Lm5hbWUgPSBjb3N0SGVhZC5uYW1lO1xyXG4gICAgICB0aHVtYlJ1bGVSZXBvcnQucmF0ZUFuYWx5c2lzSWQgPSBjb3N0SGVhZC5yYXRlQW5hbHlzaXNJZDtcclxuICAgICAgdGh1bWJSdWxlUmVwb3J0LmFtb3VudCA9IE1hdGgucm91bmQoY29zdEhlYWQuYnVkZ2V0ZWRDb3N0QW1vdW50KTtcclxuICAgICAgdGh1bWJSdWxlUmVwb3J0LmNvc3RIZWFkQWN0aXZlID0gY29zdEhlYWQuYWN0aXZlO1xyXG4gICAgICB0aHVtYlJ1bGVSZXBvcnQucmF0ZSA9IHBhcnNlRmxvYXQoKHRodW1iUnVsZVJlcG9ydC5hbW91bnQgLyB0b3RhbEFyZWEpLnRvRml4ZWQoMikpO1xyXG4gICAgIC8qIGlmIChyYXRlVW5pdCA9PT0gQ29uc3RhbnRzLlNRVVJFTUVURVJfVU5JVCkge1xyXG4gICAgICAgIHRodW1iUnVsZVJlcG9ydC5yYXRlID0gcGFyc2VGbG9hdCgodGh1bWJSdWxlUmVwb3J0LnJhdGUgKiBjb25maWcuZ2V0KENvbnN0YW50cy5TUVVBUkVfTUVURVIpKS50b0ZpeGVkKDIpKTtcclxuICAgICAgfSovXHJcbiAgICAgIHRodW1iUnVsZVJlcG9ydHMucHVzaCh0aHVtYlJ1bGVSZXBvcnQpO1xyXG5cclxuICAgICAgLy9Fc3RpbWF0ZWQgY29zdCBSZXBvcnRcclxuICAgICAgbGV0IGVzdGltYXRlUmVwb3J0ID0gbmV3IEVzdGltYXRlUmVwb3J0KCk7XHJcbiAgICAgIGVzdGltYXRlUmVwb3J0ID0gdGhpcy5nZXRFc3RpbWF0ZWRSZXBvcnQocHJvamVjdFJhdGVzLCBjb3N0SGVhZCwgdG90YWxBcmVhLCByYXRlVW5pdCk7XHJcbiAgICAgIGVzdGltYXRlZFJlcG9ydHMucHVzaChlc3RpbWF0ZVJlcG9ydCk7XHJcbiAgICB9XHJcbiAgIH1cclxuICB9XHJcblxyXG5cclxuICBnZXRDb3N0SGVhZHMoICB1cmw6IHN0cmluZyAsIHVzZXI6IFVzZXIsY2FsbGJhY2s6IChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4gdm9pZCkge1xyXG4gICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBnZXRDb3N0SGVhZHMgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICB0aGlzLnJhdGVBbmFseXNpc1NlcnZpY2UuZ2V0Q29zdEhlYWRzKCB1cmwsIHVzZXIsKGVycm9yLCByZXN1bHQpID0+IHtcclxuICAgICAgaWYoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZXJyb3IgOiAnK0pTT04uc3RyaW5naWZ5KGVycm9yKSk7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwseyBkYXRhOiByZXN1bHQsIGFjY2Vzc190b2tlbjogdGhpcy5hdXRoSW50ZXJjZXB0b3IuaXNzdWVUb2tlbldpdGhVaWQodXNlcil9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRXb3JrSXRlbXMoIHVybDogc3RyaW5nICwgdXNlcjogVXNlciwgY2FsbGJhY2s6IChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4gdm9pZCkge1xyXG4gICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBnZXRXb3JrSXRlbXMgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICB0aGlzLnJhdGVBbmFseXNpc1NlcnZpY2UuZ2V0V29ya0l0ZW1zKCB1cmwsIHVzZXIsKGVycm9yLCByZXN1bHQpID0+IHtcclxuICAgICAgaWYoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZXJyb3IgOiAnK0pTT04uc3RyaW5naWZ5KGVycm9yKSk7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwseyBkYXRhOiByZXN1bHQsIGFjY2Vzc190b2tlbjogdGhpcy5hdXRoSW50ZXJjZXB0b3IuaXNzdWVUb2tlbldpdGhVaWQodXNlcil9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRNYXRlcmlhbERldGFpbHMoIHByb2plY3RJZCA6IGFueSzigIJ1c2VyOiBVc2VyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4gdm9pZCkge1xyXG5cclxuICAgIGxvZ2dlci5pbmZvKCdSZXBvcnQgU2VydmljZSwgZ2V0TWF0ZXJpYWxEZXRhaWxzIGhhcyBiZWVuIGhpdCcpO1xyXG4gICAgbGV0IHF1ZXJ5ID0geyBfaWQ6IHByb2plY3RJZH07XHJcbiAgICBsZXQgcG9wdWxhdGUgPSB7cGF0aCA6ICdidWlsZGluZ3MnfTtcclxuICAgIHRoaXMucHJvamVjdFJlcG9zaXRvcnkuZmluZEFuZFBvcHVsYXRlKHF1ZXJ5LCBwb3B1bGF0ZSwgKGVycm9yLCByZXN1bHQpID0+IHtcclxuICAgICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBmaW5kQW5kUG9wdWxhdGUgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICAgIGlmKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHRoaXMuZ2V0QnVpbGRpbmdNYXRlcmlhbERldGFpbHMocmVzdWx0WzBdLmJ1aWxkaW5ncykpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEJ1aWxkaW5nTWF0ZXJpYWxEZXRhaWxzKGJ1aWxkaW5ncyA6IEFycmF5PEJ1aWxkaW5nPik6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPiB7XHJcbiAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheSA6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPj0gbmV3IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPigpO1xyXG4gICAgbGV0IGJ1aWxkaW5nTmFtZTogc3RyaW5nO1xyXG4gICAgZm9yKGxldCBidWlsZGluZzogQnVpbGRpbmcgb2YgYnVpbGRpbmdzKSB7XHJcbiAgICAgIGJ1aWxkaW5nTmFtZSA9IGJ1aWxkaW5nLm5hbWU7XHJcbiAgICAgIHRoaXMuYWRkTWF0ZXJpYWxEVE9Gb3JBY3RpdmVDb3N0SGVhZEluRFRPQXJyYXkoYnVpbGRpbmcsIGJ1aWxkaW5nTmFtZSwgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheSk7XHJcblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXk7XHJcbiAgfVxyXG5cclxuICBnZXRNYXRlcmlhbEZpbHRlcnMoIHByb2plY3RJZCA6IGFueSzigIJ1c2VyOiBVc2VyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4gdm9pZCkge1xyXG5cclxuICAgIGxvZ2dlci5pbmZvKCdSZXBvcnQgU2VydmljZSwgZ2V0TWF0ZXJpYWxGaWx0ZXJzIGhhcyBiZWVuIGhpdCcpO1xyXG4gICAgbGV0IHF1ZXJ5ID0geyBfaWQ6IHByb2plY3RJZH07XHJcbiAgICBsZXQgcG9wdWxhdGUgPSB7cGF0aCA6ICdidWlsZGluZ3MnfTtcclxuICAgIHRoaXMucHJvamVjdFJlcG9zaXRvcnkuZmluZEFuZFBvcHVsYXRlKHF1ZXJ5LCBwb3B1bGF0ZSwgKGVycm9yLCByZXN1bHQpID0+IHtcclxuICAgICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBmaW5kQW5kUG9wdWxhdGUgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICAgIGlmKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHRoaXMuZ2V0TWF0ZXJpYWxUYWtlT2ZmRmlsdGVyT2JqZWN0KHJlc3VsdFswXS5idWlsZGluZ3MpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRNYXRlcmlhbFRha2VPZmZSZXBvcnQoIHByb2plY3RJZCA6IGFueSwgYnVpbGRpbmc6IHN0cmluZywgZWxlbWVudFdpc2VSZXBvcnQ6IHN0cmluZywgZWxlbWVudDogc3RyaW5nLOKAgnVzZXI6IFVzZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB2b2lkKSB7XHJcblxyXG4gICAgbG9nZ2VyLmluZm8oJ1JlcG9ydCBTZXJ2aWNlLCBnZXRNYXRlcmlhbFRha2VPZmZSZXBvcnQgaGFzIGJlZW4gaGl0Jyk7XHJcbiAgICBsZXQgcXVlcnkgPSB7IF9pZDogcHJvamVjdElkfTtcclxuICAgIGxldCBwb3B1bGF0ZSA9IHtwYXRoIDogJ2J1aWxkaW5ncyd9O1xyXG4gICAgdGhpcy5wcm9qZWN0UmVwb3NpdG9yeS5maW5kQW5kUG9wdWxhdGUocXVlcnksIHBvcHVsYXRlLCAoZXJyb3IsIHJlc3VsdCkgPT4ge1xyXG4gICAgICBsb2dnZXIuaW5mbygnUmVwb3J0IFNlcnZpY2UsIGZpbmRBbmRQb3B1bGF0ZSBoYXMgYmVlbiBoaXQnKTtcclxuICAgICAgaWYoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXk6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPiA9IHRoaXMuZ2V0QnVpbGRpbmdNYXRlcmlhbERldGFpbHMocmVzdWx0WzBdLmJ1aWxkaW5ncyk7XHJcbiAgICAgICAgbGV0IG1hdGVyaWFsUmVwb3J0Um93RGF0YSA9XHJcbiAgICAgICAgICB0aGlzLmdldE1hdGVyaWFsRGF0YUZyb21GbGF0RGV0YWlsc0FycmF5KGVsZW1lbnRXaXNlUmVwb3J0LCBlbGVtZW50LCBidWlsZGluZywgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheSk7XHJcbiAgICAgICAgbGV0IG1hdGVyaWFsVGFrZU9mZlJlcG9ydDogTWF0ZXJpYWxUYWtlT2ZmUmVwb3J0ID0gbmV3IE1hdGVyaWFsVGFrZU9mZlJlcG9ydChudWxsLCBudWxsKTtcclxuICAgICAgICBtYXRlcmlhbFRha2VPZmZSZXBvcnQuc2Vjb25kYXJ5VmlldyA9IHt9O1xyXG4gICAgICAgICAgdGhpcy5wb3B1bGF0ZU1hdGVyaWFsVGFrZU9mZlJlcG9ydEZyb21Sb3dEYXRhKG1hdGVyaWFsUmVwb3J0Um93RGF0YSwgbWF0ZXJpYWxUYWtlT2ZmUmVwb3J0LCBidWlsZGluZyk7XHJcbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9IHt9O1xyXG4gICAgICAgIHJlc3BvbnNlRGF0YVtlbGVtZW50XT0gbWF0ZXJpYWxUYWtlT2ZmUmVwb3J0O1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlRGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwb3B1bGF0ZU1hdGVyaWFsVGFrZU9mZlJlcG9ydEZyb21Sb3dEYXRhKG1hdGVyaWFsUmVwb3J0Um93RGF0YTogYW55LCBtYXRlcmlhbFRha2VPZmZSZXBvcnQ6IE1hdGVyaWFsVGFrZU9mZlJlcG9ydCwgYnVpbGRpbmc6IHN0cmluZykge1xyXG4gICAgZm9yIChsZXQgcmVjb3JkIG9mIG1hdGVyaWFsUmVwb3J0Um93RGF0YSkge1xyXG4gICAgICBpZiAobWF0ZXJpYWxUYWtlT2ZmUmVwb3J0LnNlY29uZGFyeVZpZXdbcmVjb3JkLmhlYWRlcl0gIT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgIG1hdGVyaWFsVGFrZU9mZlJlcG9ydC5zZWNvbmRhcnlWaWV3W3JlY29yZC5oZWFkZXJdICE9PSBudWxsKSB7ICAgICAgICAgLy8gY2hlY2sgaWYgbWF0ZXJpYWwgaXMgaW4gbWFwXHJcbiAgICAgICAgbGV0IG1hdGVyaWFsVGFrZU9mZlNlY29uZGFyeVZpZXc6IE1hdGVyaWFsVGFrZU9mZlNlY29uZGFyeVZpZXcgPVxyXG4gICAgICAgICAgbWF0ZXJpYWxUYWtlT2ZmUmVwb3J0LnNlY29uZGFyeVZpZXdbcmVjb3JkLmhlYWRlcl07XHJcbiAgICAgICAgbGV0IHRhYmxlOiBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXcgPSBtYXRlcmlhbFRha2VPZmZTZWNvbmRhcnlWaWV3LnRhYmxlO1xyXG4gICAgICAgIGlmICh0YWJsZS5jb250ZW50W3JlY29yZC5yb3dWYWx1ZV0gIT09IHVuZGVmaW5lZCAmJiB0YWJsZS5jb250ZW50W3JlY29yZC5yb3dWYWx1ZV0gIT09IG51bGwpIHtcclxuICAgICAgICAgIGxldCB0YWJsZVZpZXdDb250ZW50OiBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdDb250ZW50ID0gdGFibGUuY29udGVudFtyZWNvcmQucm93VmFsdWVdO1xyXG4gICAgICAgICAgdGFibGVWaWV3Q29udGVudC5jb2x1bW5Ud28gPSB0YWJsZVZpZXdDb250ZW50LmNvbHVtblR3byArIHJlY29yZC5Ub3RhbDsgICAvLyB1cGRhdGUgdG90YWxcclxuICAgICAgICAgIGlmIChyZWNvcmQuc3ViVmFsdWUpIHtcclxuICAgICAgICAgICAgdGFibGVWaWV3Q29udGVudC5zdWJDb250ZW50W3JlY29yZC5zdWJWYWx1ZV0gPVxyXG4gICAgICAgICAgICAgIG5ldyBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdTdWJDb250ZW50KHJlY29yZC5zdWJWYWx1ZSwgcmVjb3JkLlRvdGFsLCByZWNvcmQudW5pdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxldCBzdWJDb250ZW50TWFwID0ge307XHJcbiAgICAgICAgICBpZiAocmVjb3JkLnN1YlZhbHVlKSB7XHJcbiAgICAgICAgICAgIGxldCBtYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdTdWJDb250ZW50ID1cclxuICAgICAgICAgICAgICBuZXcgTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3U3ViQ29udGVudChyZWNvcmQuc3ViVmFsdWUsIHJlY29yZC5Ub3RhbCwgcmVjb3JkLnVuaXQpO1xyXG4gICAgICAgICAgICBzdWJDb250ZW50TWFwW3JlY29yZC5zdWJWYWx1ZV0gPSBtYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdTdWJDb250ZW50O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbGV0IHRhYmxlVmlld0NvbnRlbnQ6IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0NvbnRlbnQgPVxyXG4gICAgICAgICAgICBuZXcgTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Q29udGVudChyZWNvcmQucm93VmFsdWUsIHJlY29yZC5Ub3RhbCwgcmVjb3JkLnVuaXQsIHN1YkNvbnRlbnRNYXApO1xyXG4gICAgICAgICAgdGFibGUuY29udGVudFtyZWNvcmQucm93VmFsdWVdID0gdGFibGVWaWV3Q29udGVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGFibGUuZm9vdGVyLmNvbHVtblR3byA9IHRhYmxlLmZvb3Rlci5jb2x1bW5Ud28gKyByZWNvcmQuVG90YWw7XHJcbiAgICAgICAgbWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5Vmlldy5oZWFkZXIgPSB0YWJsZS5mb290ZXIuY29sdW1uVHdvICsgJyAnICsgcmVjb3JkLnVuaXQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHN1YkNvbnRlbnRNYXAgPSB7fTtcclxuICAgICAgICBpZiAocmVjb3JkLnN1YlZhbHVlKSB7XHJcbiAgICAgICAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3U3ViQ29udGVudCA9IG5ldyBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdTdWJDb250ZW50KHJlY29yZC5zdWJWYWx1ZSwgcmVjb3JkLlRvdGFsLCAnQkFHJyk7XHJcbiAgICAgICAgICBzdWJDb250ZW50TWFwW3JlY29yZC5zdWJWYWx1ZV0gPSBtYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdTdWJDb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgdGFibGVWaWV3Q29udGVudDogTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Q29udGVudCA9XHJcbiAgICAgICAgICBuZXcgTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Q29udGVudChyZWNvcmQucm93VmFsdWUsIHJlY29yZC5Ub3RhbCwgcmVjb3JkLnVuaXQsIHN1YkNvbnRlbnRNYXApO1xyXG4gICAgICAgIGxldCB0YWJsZVZpZXdDb250ZW50TWFwID0ge307XHJcbiAgICAgICAgdGFibGVWaWV3Q29udGVudE1hcFtyZWNvcmQucm93VmFsdWVdID0gdGFibGVWaWV3Q29udGVudDtcclxuICAgICAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3SGVhZGVyOiBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdIZWFkZXJzID1cclxuICAgICAgICAgIG5ldyBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdIZWFkZXJzKCdJdGVtJywgJ1F1YW50aXR5JywgJ1VuaXQnKTtcclxuICAgICAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Rm9vdGVyOiBNYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdGb290ZXIgPVxyXG4gICAgICAgICAgbmV3IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0Zvb3RlcignVG90YWwnLCByZWNvcmQuVG90YWwsIHJlY29yZC51bml0KTtcclxuICAgICAgICBsZXQgdGFibGU6IE1hdGVyaWFsVGFrZU9mZlRhYmxlVmlldyA9XHJcbiAgICAgICAgICBuZXcgTWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3KG1hdGVyaWFsVGFrZU9mZlRhYmxlVmlld0hlYWRlciwgdGFibGVWaWV3Q29udGVudE1hcCwgbWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Rm9vdGVyKTtcclxuICAgICAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5VmlldzogTWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5VmlldyA9XHJcbiAgICAgICAgICBuZXcgTWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5VmlldyhtYXRlcmlhbFRha2VPZmZUYWJsZVZpZXdGb290ZXIuY29sdW1uVHdvICsgJyAnICsgbWF0ZXJpYWxUYWtlT2ZmVGFibGVWaWV3Rm9vdGVyLmNvbHVtblRocmVlLFxyXG4gICAgICAgICAgICB0YWJsZSk7XHJcbiAgICAgICAgbWF0ZXJpYWxUYWtlT2ZmUmVwb3J0LmhlYWRlciA9IGJ1aWxkaW5nO1xyXG4gICAgICAgIG1hdGVyaWFsVGFrZU9mZlJlcG9ydC5zZWNvbmRhcnlWaWV3W3JlY29yZC5oZWFkZXJdID0gbWF0ZXJpYWxUYWtlT2ZmU2Vjb25kYXJ5VmlldztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRNYXRlcmlhbERhdGFGcm9tRmxhdERldGFpbHNBcnJheShlbGVtZW50V2lzZVJlcG9ydDogc3RyaW5nLCBlbGVtZW50OiBzdHJpbmcsIGJ1aWxkaW5nOiBzdHJpbmcsIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXk6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPikge1xyXG4gICAgbGV0IHNxbFF1ZXJ5OiBzdHJpbmc7XHJcbiAgICBzd2l0Y2goZWxlbWVudFdpc2VSZXBvcnQpIHtcclxuICAgICAgY2FzZSBDb25zdGFudHMuU1RSX0NPU1RIRUFEOlxyXG4gICAgICAgIHNxbFF1ZXJ5ID0gdGhpcy5hbGFzcWxRdWVyeUZvck1hdGVyaWFsVGFrZU9mZkRhdGFDb3N0SGVhZFdpc2UoYnVpbGRpbmcpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIENvbnN0YW50cy5TVFJfTUFURVJJQUw6XHJcbiAgICAgICAgc3FsUXVlcnkgPSB0aGlzLmFsYXNxbFF1ZXJ5Rm9yTWF0ZXJpYWxUYWtlT2ZmRGF0YU1hdGVyaWFsV2lzZShidWlsZGluZyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBsZXQgbWF0ZXJpYWxSZXBvcnRSb3dEYXRhID0gYWxhc3FsKHNxbFF1ZXJ5LCBbbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheSxlbGVtZW50XSk7XHJcbiAgICByZXR1cm4gbWF0ZXJpYWxSZXBvcnRSb3dEYXRhO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhbGFzcWxRdWVyeUZvck1hdGVyaWFsVGFrZU9mZkRhdGFNYXRlcmlhbFdpc2UoYnVpbGRpbmc6IHN0cmluZykge1xyXG4gICAgbGV0IHNlbGVjdDogc3RyaW5nID0gQ29uc3RhbnRzLlNUUl9FTVBUWTtcclxuICAgIGxldCBmcm9tOiBzdHJpbmcgPSBDb25zdGFudHMuQUxBU1FMX0ZST007XHJcbiAgICBsZXQgd2hlcmU6IHN0cmluZyA9IENvbnN0YW50cy5TVFJfRU1QVFk7XHJcbiAgICBsZXQgZ3JvdXBCeTogc3RyaW5nID0gQ29uc3RhbnRzLkFMQVNRTF9HUk9VUF9CWV9NQVRFUklBTF9UQUtFT0ZGX01BVEVSSUFMX1dJU0U7XHJcbiAgICBsZXQgb3JkZXJCeTogc3RyaW5nID0gQ29uc3RhbnRzLkFMQVNRTF9PUkRFUl9CWV9NQVRFUklBTF9UQUtFT0ZGX01BVEVSSUFMX1dJU0U7XHJcbiAgICBsZXQgc3FsUXVlcnk6IHN0cmluZztcclxuICAgIGlmIChidWlsZGluZyAhPT0gQ29uc3RhbnRzLlNUUl9BTExfQlVJTERJTkcpIHtcclxuICAgICAgc2VsZWN0ID0gQ29uc3RhbnRzLkFMQVNRTF9TRUxFQ1RfTUFURVJJQUxfVEFLRU9GRl9NQVRFUklBTF9XSVNFICsgQ29uc3RhbnRzLlNUUl9DT01NQV9TUEFDRSArXHJcbiAgICAgICAgQ29uc3RhbnRzLkFMQVNRTF9TRUxFQ1RfUVVBTlRJVFlfTkFNRV9BUztcclxuICAgICAgd2hlcmUgPSBDb25zdGFudHMuQUxBU1FMX1dIRVJFX01BVEVSSUFMX05BTUVfRVFVQUxTX1RPICArXHJcbiAgICAgICAgQ29uc3RhbnRzLlNUUl9BTkQgKyBDb25zdGFudHMuQUxBU1FMX1NFTEVDVF9CVUlMRElOR19OQU1FICsgYnVpbGRpbmcgKyBDb25zdGFudHMuU1RSX0RPVUJMRV9JTlZFUlRFRF9DT01NQTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGVjdCA9IENvbnN0YW50cy5BTEFTUUxfU0VMRUNUX01BVEVSSUFMX1RBS0VPRkZfTUFURVJJQUxfV0lTRSA7XHJcbiAgICAgIHdoZXJlID0gQ29uc3RhbnRzLkFMQVNRTF9XSEVSRV9NQVRFUklBTF9OQU1FX0VRVUFMU19UTyA7XHJcbiAgICB9XHJcbiAgICBzcWxRdWVyeSA9IHNlbGVjdCArIGZyb20gKyB3aGVyZSArIGdyb3VwQnkgKyBvcmRlckJ5O1xyXG4gICAgcmV0dXJuIHNxbFF1ZXJ5O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhbGFzcWxRdWVyeUZvck1hdGVyaWFsVGFrZU9mZkRhdGFDb3N0SGVhZFdpc2UoYnVpbGRpbmc6IHN0cmluZykge1xyXG4gICAgbGV0IHNlbGVjdDogc3RyaW5nID0gQ29uc3RhbnRzLlNUUl9FTVBUWTtcclxuICAgIGxldCBmcm9tOiBzdHJpbmcgPSBDb25zdGFudHMuQUxBU1FMX0ZST007XHJcbiAgICBsZXQgd2hlcmU6IHN0cmluZyA9IENvbnN0YW50cy5TVFJfRU1QVFk7XHJcbiAgICBsZXQgZ3JvdXBCeTogc3RyaW5nID0gQ29uc3RhbnRzLlNUUl9FTVBUWTtcclxuICAgIGxldCBvcmRlckJ5OiBzdHJpbmcgPSBDb25zdGFudHMuU1RSX0VNUFRZO1xyXG4gICAgbGV0IHNxbFF1ZXJ5OiBzdHJpbmc7XHJcbiAgICBpZiAoYnVpbGRpbmcgIT09IENvbnN0YW50cy5TVFJfQUxMX0JVSUxESU5HKSB7XHJcbiAgICAgIHNlbGVjdCA9IENvbnN0YW50cy5BTEFTUUxfU0VMRUNUX01BVEVSSUFMX1RBS0VPRkZfQ09TVEhFQURfV0lTRSArIENvbnN0YW50cy5TVFJfQ09NTUFfU1BBQ0UgK1xyXG4gICAgICAgIENvbnN0YW50cy5BTEFTUUxfU0VMRUNUX1FVQU5USVRZX05BTUVfQVM7XHJcbiAgICAgIHdoZXJlID0gQ29uc3RhbnRzLkFMQVNRTF9XSEVSRV9DT1NUSEVBRF9OQU1FX0VRVUFMU19UT1xyXG4gICAgICAgICsgQ29uc3RhbnRzLlNUUl9BTkQgKyBDb25zdGFudHMuQUxBU1FMX1NFTEVDVF9CVUlMRElOR19OQU1FICsgYnVpbGRpbmcgKyBDb25zdGFudHMuU1RSX0RPVUJMRV9JTlZFUlRFRF9DT01NQTtcclxuICAgICAgZ3JvdXBCeSA9IENvbnN0YW50cy5BTEFTUUxfR1JPVVBfTUFURVJJQUxfV09SS0lURU1fUVVBTlRJVFlfTUFURVJJQUxfVEFLRU9GRl9DT1NUSEVBRF9XSVNFO1xyXG4gICAgICBvcmRlckJ5ID0gQ29uc3RhbnRzLkFMQVNRTF9PUkRFUl9CWV9NQVRFUklBTF9XT1JLSVRFTV9DT1NUSEVBRF9XSVNFO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZWN0ID0gQ29uc3RhbnRzLkFMQVNRTF9TRUxFQ1RfTUFURVJJQUxfVEFLRU9GRl9DT1NUSEVBRF9XSVNFX0ZPUl9BTExfQlVJTERJTkdTO1xyXG4gICAgICB3aGVyZSA9IENvbnN0YW50cy5BTEFTUUxfV0hFUkVfQ09TVEhFQURfTkFNRV9FUVVBTFNfVE87XHJcbiAgICAgIGdyb3VwQnkgPSBDb25zdGFudHMuQUxBU1FMX0dST1VQX01BVEVSSUFMX0JVSUxESU5HX1FVQU5USVRZX01BVEVSSUFMX1RBS0VPRkZfQ09TVEhFQURfV0lTRV9GT1JfQUxMX0JVSUxESU5HUztcclxuICAgICAgb3JkZXJCeSA9IENvbnN0YW50cy5BTEFTUUxfT1JERVJfQllfTUFURVJJQUxfQlVJTERJTkdfTUFURVJJQUxfVEFLRU9GRl9DT1NUSEVBRF9XSVNFO1xyXG4gICAgfVxyXG4gICAgc3FsUXVlcnkgPSBzZWxlY3QgKyBmcm9tICsgd2hlcmUgKyBncm91cEJ5ICsgb3JkZXJCeTtcclxuICAgIHJldHVybiBzcWxRdWVyeTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0TWF0ZXJpYWxUYWtlT2ZmRmlsdGVyT2JqZWN0KGJ1aWxkaW5nczogQXJyYXk8QnVpbGRpbmc+KSB7XHJcbiAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheTogQXJyYXk8TWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNEVE8+ID0gdGhpcy5nZXRCdWlsZGluZ01hdGVyaWFsRGV0YWlscyhidWlsZGluZ3MpO1xyXG4gICAgbGV0IGNvbHVtbjogc3RyaW5nID0gQ29uc3RhbnRzLlNUUl9CVUlMRElOR19OQU1FO1xyXG4gICAgbGV0IGJ1aWxkaW5nTGlzdDogQXJyYXk8c3RyaW5nPiA9IHRoaXMuZ2V0RGlzdGluY3RBcnJheU9mU3RyaW5nRnJvbUFsYXNxbChjb2x1bW4sIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgY29sdW1uID0gQ29uc3RhbnRzLlNUUl9DT1NUSEVBRF9OQU1FO1xyXG4gICAgbGV0IGNvc3RIZWFkTGlzdDogQXJyYXk8c3RyaW5nPiA9IHRoaXMuZ2V0RGlzdGluY3RBcnJheU9mU3RyaW5nRnJvbUFsYXNxbChjb2x1bW4sIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgY29sdW1uID0gQ29uc3RhbnRzLlNUUl9NYXRlcmlhbF9OQU1FO1xyXG4gICAgbGV0IG1hdGVyaWFsTGlzdDogQXJyYXk8c3RyaW5nPiA9IHRoaXMuZ2V0RGlzdGluY3RBcnJheU9mU3RyaW5nRnJvbUFsYXNxbChjb2x1bW4sIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgbGV0IG1hdGVyaWFsVGFrZU9mZkZpbHRlcnNPYmplY3Q6IE1hdGVyaWFsVGFrZU9mZkZpbHRlcnNMaXN0RFRPID0gbmV3IE1hdGVyaWFsVGFrZU9mZkZpbHRlcnNMaXN0RFRPKGJ1aWxkaW5nTGlzdCwgY29zdEhlYWRMaXN0LFxyXG4gICAgICBtYXRlcmlhbExpc3QpO1xyXG4gICAgcmV0dXJuIG1hdGVyaWFsVGFrZU9mZkZpbHRlcnNPYmplY3Q7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldERpc3RpbmN0QXJyYXlPZlN0cmluZ0Zyb21BbGFzcWwoY29sdW1uOiBzdHJpbmcsIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXk6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPikge1xyXG4gICAgbGV0IHNxbFF1ZXJ5OiBzdHJpbmcgPSAnU0VMRUNUIERJU1RJTkNUIGZsYXREYXRhLicgKyBjb2x1bW4gKyAnIEZST00gPyBBUyBmbGF0RGF0YSc7XHJcbiAgICBsZXQgZGlzdGluY3RPYmplY3RBcnJheSA9IGFsYXNxbChzcWxRdWVyeSwgW21hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXldKTtcclxuICAgIGxldCBkaXN0aW5jdE5hbWVTdHJpbmdBcnJheTogQXJyYXk8c3RyaW5nPiA9IG5ldyBBcnJheTxzdHJpbmc+KCk7XHJcbiAgICBmb3IobGV0IGRpc3RpbmN0T2JqZWN0IG9mIGRpc3RpbmN0T2JqZWN0QXJyYXkpIHtcclxuICAgICAgZGlzdGluY3ROYW1lU3RyaW5nQXJyYXkucHVzaChkaXN0aW5jdE9iamVjdFtjb2x1bW5dKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkaXN0aW5jdE5hbWVTdHJpbmdBcnJheTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYWRkTWF0ZXJpYWxEVE9Gb3JBY3RpdmVDb3N0SGVhZEluRFRPQXJyYXkoYnVpbGRpbmc6IEJ1aWxkaW5nLCBidWlsZGluZ05hbWU6IHN0cmluZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXk6IEFycmF5PE1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzRFRPPikge1xyXG4gICAgbGV0IGNvc3RIZWFkTmFtZTtcclxuICAgIGZvciAobGV0IGNvc3RIZWFkOiBDb3N0SGVhZCBvZiBidWlsZGluZy5jb3N0SGVhZHMpIHtcclxuICAgICAgaWYgKGNvc3RIZWFkLmFjdGl2ZSkge1xyXG4gICAgICAgIGNvc3RIZWFkTmFtZSA9IGNvc3RIZWFkLm5hbWU7XHJcbiAgICAgICAgdGhpcy5hZGRNYXRlcmlhbERUT0ZvckFjdGl2ZUNhdGVnb3J5SW5EVE9BcnJheShjb3N0SGVhZCwgYnVpbGRpbmdOYW1lLCBjb3N0SGVhZE5hbWUsIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZE1hdGVyaWFsRFRPRm9yQWN0aXZlQ2F0ZWdvcnlJbkRUT0FycmF5KGNvc3RIZWFkOiBDb3N0SGVhZCwgYnVpbGRpbmdOYW1lOiBzdHJpbmcsIGNvc3RIZWFkTmFtZTogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheTogQXJyYXk8TWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNEVE8+KSB7XHJcbiAgICBsZXQgY2F0ZWdvcnlOYW1lOiBzdHJpbmc7XHJcbiAgICBmb3IgKGxldCBjYXRlZ29yeTogQ2F0ZWdvcnkgb2YgY29zdEhlYWQuY2F0ZWdvcmllcykge1xyXG4gICAgICBpZiAoY2F0ZWdvcnkuYWN0aXZlKSB7XHJcbiAgICAgICAgY2F0ZWdvcnlOYW1lID0gY2F0ZWdvcnkubmFtZTtcclxuICAgICAgICB0aGlzLmFkZE1hdGVyaWFsRFRPRm9yQWN0aXZlV29ya2l0ZW1JbkRUT0FycmF5KGNhdGVnb3J5LCBidWlsZGluZ05hbWUsIGNvc3RIZWFkTmFtZSwgY2F0ZWdvcnlOYW1lLCBtYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0FycmF5KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRNYXRlcmlhbERUT0ZvckFjdGl2ZVdvcmtpdGVtSW5EVE9BcnJheShjYXRlZ29yeTogQ2F0ZWdvcnksIGJ1aWxkaW5nTmFtZTogc3RyaW5nLCBjb3N0SGVhZE5hbWU6IHN0cmluZyxcclxuICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5TmFtZTogc3RyaW5nLCBtYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0FycmF5OiBBcnJheTxNYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0RUTz4pIHtcclxuICAgIGxldCB3b3JrSXRlbU5hbWU6IHN0cmluZztcclxuICAgIGZvciAobGV0IHdvcmtJdGVtOiBXb3JrSXRlbSBvZiBjYXRlZ29yeS53b3JrSXRlbXMpIHtcclxuICAgICAgaWYgKHdvcmtJdGVtLmFjdGl2ZSkge1xyXG4gICAgICAgIHdvcmtJdGVtTmFtZSA9IHdvcmtJdGVtLm5hbWU7XHJcbiAgICAgICAgdGhpcy5hZGRFc3RpbWF0ZWRRdWFudGl0eUFuZFJhdGVNYXRlcmlhbEl0ZW1JbkRUT0FycmF5KHdvcmtJdGVtLCBidWlsZGluZ05hbWUsIGNvc3RIZWFkTmFtZSwgY2F0ZWdvcnlOYW1lLFxyXG4gICAgICAgICAgd29ya0l0ZW1OYW1lLCBtYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0FycmF5KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRFc3RpbWF0ZWRRdWFudGl0eUFuZFJhdGVNYXRlcmlhbEl0ZW1JbkRUT0FycmF5KHdvcmtJdGVtOiBXb3JrSXRlbSwgYnVpbGRpbmdOYW1lOiBzdHJpbmcsIGNvc3RIZWFkTmFtZTogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgOiBzdHJpbmcsIHdvcmtJdGVtTmFtZTogc3RyaW5nLCBtYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0FycmF5OiBBcnJheTxNYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0RUTz4pIHtcclxuICAgIGxldCBxdWFudGl0eU5hbWU6IHN0cmluZztcclxuICAgIGlmKHdvcmtJdGVtLnF1YW50aXR5LmlzRGlyZWN0UXVhbnRpdHkgJiYgd29ya0l0ZW0ucmF0ZS5pc0VzdGltYXRlZCkge1xyXG4gICAgICBxdWFudGl0eU5hbWUgPSBDb25zdGFudHMuU1RSX0RJUkVDVDtcclxuICAgICAgdGhpcy5jcmVhdGVBbmRBZGRNYXRlcmlhbERUT09iamVjdEluRFRPQXJyYXkod29ya0l0ZW0sIGJ1aWxkaW5nTmFtZSwgY29zdEhlYWROYW1lLCBjYXRlZ29yeU5hbWUsIHdvcmtJdGVtTmFtZSwgcXVhbnRpdHlOYW1lLFxyXG4gICAgICAgIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAod29ya0l0ZW0ucXVhbnRpdHkuaXNFc3RpbWF0ZWQgJiYgd29ya0l0ZW0ucmF0ZS5pc0VzdGltYXRlZCkge1xyXG4gICAgICBmb3IgKGxldCBxdWFudGl0eTogUXVhbnRpdHlEZXRhaWxzIG9mIHdvcmtJdGVtLnF1YW50aXR5LnF1YW50aXR5SXRlbURldGFpbHMpIHtcclxuICAgICAgICBxdWFudGl0eU5hbWUgPSBxdWFudGl0eS5uYW1lO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQW5kQWRkTWF0ZXJpYWxEVE9PYmplY3RJbkRUT0FycmF5KHdvcmtJdGVtLCBidWlsZGluZ05hbWUsIGNvc3RIZWFkTmFtZSwgY2F0ZWdvcnlOYW1lLCB3b3JrSXRlbU5hbWUsIHF1YW50aXR5TmFtZSxcclxuICAgICAgICAgIG1hdGVyaWFsVGFrZU9mZkZsYXREZXRhaWxzQXJyYXkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUFuZEFkZE1hdGVyaWFsRFRPT2JqZWN0SW5EVE9BcnJheSh3b3JrSXRlbTogV29ya0l0ZW0sIGJ1aWxkaW5nTmFtZTogc3RyaW5nLCBjb3N0SGVhZE5hbWU6IHN0cmluZywgY2F0ZWdvcnlOYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgICAgIHdvcmtJdGVtTmFtZTogc3RyaW5nLCBxdWFudGl0eU5hbWU6IHN0cmluZywgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNBcnJheTogQXJyYXk8TWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbHNEVE8+KSB7XHJcbiAgICBmb3IgKGxldCByYXRlSXRlbSBvZiB3b3JrSXRlbS5yYXRlLnJhdGVJdGVtcykge1xyXG4gICAgICBsZXQgbWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbERUTyA9IG5ldyBNYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0RUTyhidWlsZGluZ05hbWUsIGNvc3RIZWFkTmFtZSwgY2F0ZWdvcnlOYW1lLFxyXG4gICAgICAgIHdvcmtJdGVtTmFtZSwgcmF0ZUl0ZW0uaXRlbU5hbWUsIHF1YW50aXR5TmFtZSwgKCh3b3JrSXRlbS5xdWFudGl0eS50b3RhbCAvIHdvcmtJdGVtLnJhdGUucXVhbnRpdHkpICogcmF0ZUl0ZW0ucXVhbnRpdHkpLFxyXG4gICAgICAgIHJhdGVJdGVtLnVuaXQpO1xyXG4gICAgICBtYXRlcmlhbFRha2VPZmZGbGF0RGV0YWlsc0FycmF5LnB1c2gobWF0ZXJpYWxUYWtlT2ZmRmxhdERldGFpbERUTyk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5PYmplY3Quc2VhbChSZXBvcnRTZXJ2aWNlKTtcclxuZXhwb3J0ID0gUmVwb3J0U2VydmljZTtcclxuXHJcbiJdfQ==
