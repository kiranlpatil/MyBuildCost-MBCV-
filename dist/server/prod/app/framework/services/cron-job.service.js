"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var LoggerService = require("../shared/logger/LoggerService");
var mailchimp_mailer_service_1 = require("./mailchimp-mailer.service");
var sharedconstants_1 = require("../shared/sharedconstants");
var CronJob = require('cron').CronJob;
var config = require('config');
var _loggerService = new LoggerService('MAILCHIMP_MAILER_SERVICE');
var CronJobService = (function () {
    function CronJobService() {
    }
    CronJobService.prototype.OnCronJobStart = function () {
        var mailChimpMailerService = new mailchimp_mailer_service_1.MailChimpMailerService();
        var sendingMailOnProfileUpdate = new CronJob('00 30 23 * * 0-6', function () {
            mailChimpMailerService.onCronJobCandidateProfileTriggered(sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_COMPLETED_AREA_OF_WORK, config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_PROFILE_SUBMIT_25%_LISTID'));
            mailChimpMailerService.onCronJobCandidateProfileTriggered(sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_COMPLETED_CAPABILITIES, config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_PROFILE_SUBMIT_50%_LISTID'));
            mailChimpMailerService.onCronJobCandidateProfileTriggered(sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_COMPLETED_COMPLEXITIES, config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_PROFILE_SUBMIT_75%_LISTID'));
            mailChimpMailerService.onCronJobCandidateProfileTriggered(sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_ENTER_KEY_SKILLS, config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_PROFILE_SUBMIT_95%_LISTID'));
        }, null, false, 'Asia/Kolkata');
        sendingMailOnProfileUpdate.start();
    };
    return CronJobService;
}());
exports.CronJobService = CronJobService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9mcmFtZXdvcmsvc2VydmljZXMvY3Jvbi1qb2Iuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDhEQUFpRTtBQUNqRSx1RUFBb0U7QUFDcEUsNkRBQWdGO0FBRWhGLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDdEMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQy9CLElBQUssY0FBYyxHQUFrQixJQUFJLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBSW5GO0lBQUE7SUFZQSxDQUFDO0lBVkMsdUNBQWMsR0FBZDtRQUNFLElBQUksc0JBQXNCLEdBQUMsSUFBSSxpREFBc0IsRUFBRSxDQUFDO1FBQ3hELElBQUksMEJBQTBCLEdBQUcsSUFBSSxPQUFPLENBQUMsa0JBQWtCLEVBQUU7WUFDL0Qsc0JBQXNCLENBQUUsa0NBQWtDLENBQUMsdURBQXFDLENBQUMsOEJBQThCLEVBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDLENBQUM7WUFDMU0sc0JBQXNCLENBQUUsa0NBQWtDLENBQUMsdURBQXFDLENBQUMsOEJBQThCLEVBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDLENBQUM7WUFDMU0sc0JBQXNCLENBQUUsa0NBQWtDLENBQUMsdURBQXFDLENBQUMsOEJBQThCLEVBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDLENBQUM7WUFDMU0sc0JBQXNCLENBQUUsa0NBQWtDLENBQUMsdURBQXFDLENBQUMsd0JBQXdCLEVBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDLENBQUM7UUFDcE0sQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUMsY0FBYyxDQUFDLENBQUM7UUFDakMsMEJBQTBCLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDckMsQ0FBQztJQUNILHFCQUFDO0FBQUQsQ0FaQSxBQVlDLElBQUE7QUFaWSx3Q0FBYyIsImZpbGUiOiJhcHAvZnJhbWV3b3JrL3NlcnZpY2VzL2Nyb24tam9iLnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTG9nZ2VyU2VydmljZSA9IHJlcXVpcmUoJy4uL3NoYXJlZC9sb2dnZXIvTG9nZ2VyU2VydmljZScpO1xyXG5pbXBvcnQgeyBNYWlsQ2hpbXBNYWlsZXJTZXJ2aWNlIH0gZnJvbSAnLi9tYWlsY2hpbXAtbWFpbGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQge0NhbmRpZGF0ZVByb2ZpbGVVcGRhdGVUcmFja1NlcnZlclNpZGV9IGZyb20gJy4uL3NoYXJlZC9zaGFyZWRjb25zdGFudHMnO1xyXG5cclxudmFyIENyb25Kb2IgPSByZXF1aXJlKCdjcm9uJykuQ3JvbkpvYjtcclxudmFyIGNvbmZpZyA9IHJlcXVpcmUoJ2NvbmZpZycpO1xyXG52YXIgIF9sb2dnZXJTZXJ2aWNlOiBMb2dnZXJTZXJ2aWNlID0gbmV3IExvZ2dlclNlcnZpY2UoJ01BSUxDSElNUF9NQUlMRVJfU0VSVklDRScpO1xyXG5cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQ3JvbkpvYlNlcnZpY2Uge1xyXG5cclxuICBPbkNyb25Kb2JTdGFydCgpIHtcclxuICAgIHZhciBtYWlsQ2hpbXBNYWlsZXJTZXJ2aWNlPW5ldyBNYWlsQ2hpbXBNYWlsZXJTZXJ2aWNlKCk7XHJcbiAgICB2YXIgc2VuZGluZ01haWxPblByb2ZpbGVVcGRhdGUgPSBuZXcgQ3JvbkpvYignMDAgMzAgMjMgKiAqIDAtNicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbWFpbENoaW1wTWFpbGVyU2VydmljZS4gb25Dcm9uSm9iQ2FuZGlkYXRlUHJvZmlsZVRyaWdnZXJlZChDYW5kaWRhdGVQcm9maWxlVXBkYXRlVHJhY2tTZXJ2ZXJTaWRlLlNURVBfSVNfQ09NUExFVEVEX0FSRUFfT0ZfV09SSyxjb25maWcuZ2V0KCdUcGxTZWVkLm1haWwuTUFJTENISU1QX0NBTkRJREFURV9QUk9GSUxFX1NVQk1JVF8yNSVfTElTVElEJykpO1xyXG4gICAgICBtYWlsQ2hpbXBNYWlsZXJTZXJ2aWNlLiBvbkNyb25Kb2JDYW5kaWRhdGVQcm9maWxlVHJpZ2dlcmVkKENhbmRpZGF0ZVByb2ZpbGVVcGRhdGVUcmFja1NlcnZlclNpZGUuU1RFUF9JU19DT01QTEVURURfQ0FQQUJJTElUSUVTLGNvbmZpZy5nZXQoJ1RwbFNlZWQubWFpbC5NQUlMQ0hJTVBfQ0FORElEQVRFX1BST0ZJTEVfU1VCTUlUXzUwJV9MSVNUSUQnKSk7XHJcbiAgICAgIG1haWxDaGltcE1haWxlclNlcnZpY2UuIG9uQ3JvbkpvYkNhbmRpZGF0ZVByb2ZpbGVUcmlnZ2VyZWQoQ2FuZGlkYXRlUHJvZmlsZVVwZGF0ZVRyYWNrU2VydmVyU2lkZS5TVEVQX0lTX0NPTVBMRVRFRF9DT01QTEVYSVRJRVMsY29uZmlnLmdldCgnVHBsU2VlZC5tYWlsLk1BSUxDSElNUF9DQU5ESURBVEVfUFJPRklMRV9TVUJNSVRfNzUlX0xJU1RJRCcpKTtcclxuICAgICAgbWFpbENoaW1wTWFpbGVyU2VydmljZS4gb25Dcm9uSm9iQ2FuZGlkYXRlUHJvZmlsZVRyaWdnZXJlZChDYW5kaWRhdGVQcm9maWxlVXBkYXRlVHJhY2tTZXJ2ZXJTaWRlLlNURVBfSVNfRU5URVJfS0VZX1NLSUxMUyxjb25maWcuZ2V0KCdUcGxTZWVkLm1haWwuTUFJTENISU1QX0NBTkRJREFURV9QUk9GSUxFX1NVQk1JVF85NSVfTElTVElEJykpO1xyXG4gICAgICB9LCBudWxsLCBmYWxzZSwnQXNpYS9Lb2xrYXRhJyk7XHJcbiAgICBzZW5kaW5nTWFpbE9uUHJvZmlsZVVwZGF0ZS5zdGFydCgpO1xyXG4gIH1cclxufVxyXG4iXX0=
