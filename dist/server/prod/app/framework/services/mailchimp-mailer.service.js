"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var CandidateRepository = require("../dataaccess/repository/candidate.repository");
var UserRepository = require("../dataaccess/repository/user.repository");
var LoggerService = require("../shared/logger/LoggerService");
var sharedconstants_1 = require("../shared/sharedconstants");
var _loggerService = new LoggerService('MAILCHIMP_MAILER_SERVICE');
var CronJob = require('cron').CronJob;
var config = require('config');
var mailchimp = require('mailchimp-api-v3');
var mailchimpClient = new mailchimp(config.get('TplSeed.mail.MAIL_CHIMP_SERVICE_KEY'));
var md5 = require('md5');
var MailChimpMailerService = (function () {
    function MailChimpMailerService() {
    }
    MailChimpMailerService.prototype.onCandidateSignSuccess = function (user) {
        var listId = config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_SIGN_IN_SUCCESS_LISTID');
        this.triggerMailChimpService(user, listId);
    };
    MailChimpMailerService.prototype.onCandidatePofileSubmitted = function (user, isSubmitted, isEditingProfile) {
        if (!isEditingProfile && isSubmitted) {
            var listId = config.get('TplSeed.mail.MAILCHIMP_CANDIDATE_PROFILE_SUBMIT_SUCCESS_LISTID');
            this.triggerMailChimpService(user, listId);
        }
    };
    MailChimpMailerService.prototype.onCronJobCandidateProfileTriggered = function (profile_update_track, listId) {
        var _this = this;
        this.candidateRepository = new CandidateRepository();
        this.userRepository = new UserRepository();
        var today = new Date();
        var yesterday = new Date(today);
        yesterday.setDate(today.getDate() - 1);
        var data;
        var trackNumber = sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_ENTER_KEY_SKILLS;
        var trackNumberNotSubmitted = sharedconstants_1.CandidateProfileUpdateTrackServerSide.STEP_IS_SUBMIT_DETAILS;
        if (profile_update_track === trackNumber) {
            data = {
                'profile_update_tracking': { $gte: trackNumber, $lt: trackNumberNotSubmitted },
                'lastUpdateAt': { $lt: new Date(), $gt: new Date(yesterday) }
            };
        }
        else {
            data = {
                'profile_update_tracking': profile_update_track,
                'lastUpdateAt': { $lt: new Date(), $gt: new Date(yesterday) }
            };
        }
        this.candidateRepository.retrieveWithIncluded(data, { 'userId': 1 }, function (err, res) {
            if (err) {
                _loggerService.logError(err);
            }
            else {
                for (var _i = 0, res_1 = res; _i < res_1.length; _i++) {
                    var item = res_1[_i];
                    _this.userRepository.retrieveWithIncluded({ '_id': item.userId }, { 'email': 1, 'first_name': 1, 'last_name': 1 }, function (err, res) {
                        if (err) {
                            _loggerService.logError(err);
                        }
                        else {
                            _this.triggerMailChimpService(res[0], listId);
                        }
                    });
                }
            }
        });
    };
    MailChimpMailerService.prototype.triggerMailChimpService = function (data, listId) {
        var md5String = md5(data.email);
        mailchimpClient.put('/lists/' + listId + '/members/' + md5String, {
            email_address: data.email,
            status: 'subscribed',
            merge_fields: {
                'FNAME': data.first_name,
                'LNAME': data.last_name
            }
        }).then(function (results) {
            _loggerService.logInfo(results);
        })
            .catch(function (err) {
            _loggerService.logError(err);
        });
    };
    return MailChimpMailerService;
}());
exports.MailChimpMailerService = MailChimpMailerService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9mcmFtZXdvcmsvc2VydmljZXMvbWFpbGNoaW1wLW1haWxlci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUZBQXNGO0FBQ3RGLHlFQUE0RTtBQUM1RSw4REFBaUU7QUFDakUsNkRBQWdGO0FBRWhGLElBQUksY0FBYyxHQUFrQixJQUFJLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBQ2xGLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDdEMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBRS9CLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFBO0FBQzNDLElBQUksZUFBZSxHQUFHLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMscUNBQXFDLENBQUMsQ0FBQyxDQUFDO0FBQ3ZGLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUV6QjtJQUFBO0lBNEZBLENBQUM7SUF4RkMsdURBQXNCLEdBQXRCLFVBQXVCLElBQVM7UUFDOUIsSUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyx5REFBeUQsQ0FBQyxDQUFDO1FBQ25GLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQXFCRCwyREFBMEIsR0FBMUIsVUFBMkIsSUFBUyxFQUFFLFdBQW1CLEVBQUMsZ0JBQXlCO1FBQ2pGLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQztZQUNyQyxJQUFJLE1BQU0sR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLGdFQUFnRSxDQUFDLENBQUM7WUFDMUYsSUFBSSxDQUFDLHVCQUF1QixDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUM3QyxDQUFDO0lBRUgsQ0FBQztJ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RUFBRSxJQUFJLENBQUMsVUFBVTtnQkFDdEIsT0FBTyxFQUFDLElBQUksQ0FBQyxTQUFTO2FBQ3pCO1NBQ0EsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLE9BQVk7WUFDNUIsY0FBYyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUM7YUFDQyxLQUFLLENBQUMsVUFBVSxHQUFRO1lBQ3ZCLGNBQWMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDL0IsQ0FBQyxDQUFDLENBQUE7SUFDTixDQUFDO0lBQ0gsNkJBQUM7QUFBRCxDQTVGQSxBQTRGQyxJQUFBO0FBNUZZLHdEQUFzQiIsImZpbGUiOiJhcHAvZnJhbWV3b3JrL3NlcnZpY2VzL21haWxjaGltcC1tYWlsZXIuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYW5kaWRhdGVSZXBvc2l0b3J5ID0gcmVxdWlyZSgnLi4vZGF0YWFjY2Vzcy9yZXBvc2l0b3J5L2NhbmRpZGF0ZS5yZXBvc2l0b3J5Jyk7XHJcbmltcG9ydCBVc2VyUmVwb3NpdG9yeSA9IHJlcXVpcmUoJy4uL2RhdGFhY2Nlc3MvcmVwb3NpdG9yeS91c2VyLnJlcG9zaXRvcnknKTtcclxuaW1wb3J0IExvZ2dlclNlcnZpY2UgPSByZXF1aXJlKCcuLi9zaGFyZWQvbG9nZ2VyL0xvZ2dlclNlcnZpY2UnKTtcclxuaW1wb3J0IHtDYW5kaWRhdGVQcm9maWxlVXBkYXRlVHJhY2tTZXJ2ZXJTaWRlfSBmcm9tIFwiLi4vc2hhcmVkL3NoYXJlZGNvbnN0YW50c1wiO1xyXG5cclxubGV0IF9sb2dnZXJTZXJ2aWNlOiBMb2dnZXJTZXJ2aWNlID0gbmV3IExvZ2dlclNlcnZpY2UoJ01BSUxDSElNUF9NQUlMRVJfU0VSVklDRScpO1xyXG52YXIgQ3JvbkpvYiA9IHJlcXVpcmUoJ2Nyb24nKS5Dcm9uSm9iO1xyXG52YXIgY29uZmlnID0gcmVxdWlyZSgnY29uZmlnJyk7XHJcblxyXG5sZXQgbWFpbGNoaW1wID0gcmVxdWlyZSgnbWFpbGNoaW1wLWFwaS12MycpXHJcbmxldCBtYWlsY2hpbXBDbGllbnQgPSBuZXcgbWFpbGNoaW1wKGNvbmZpZy5nZXQoJ1RwbFNlZWQubWFpbC5NQUlMX0NISU1QX1NFUlZJQ0VfS0VZJykpO1xyXG5sZXQgbWQ1ID0gcmVxdWlyZSgnbWQ1Jyk7XHJcblxyXG5leHBvcnQgY2xhc3MgTWFpbENoaW1wTWFpbGVyU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBjYW5kaWRhdGVSZXBvc2l0b3J5OiBDYW5kaWRhdGVSZXBvc2l0b3J5O1xyXG4gIHByaXZhdGUgdXNlclJlcG9zaXRvcnk6IFVzZXJSZXBvc2l0b3J5O1xyXG5cclxuICBvbkNhbmRpZGF0ZVNpZ25TdWNjZXNzKHVzZXI6IGFueSkge1xyXG4gICAgbGV0IGxpc3RJZCA9IGNvbmZpZy5nZXQoJ1RwbFNlZWQubWFpbC5NQUlMQ0hJTVBfQ0FORElEQVRFX1NJR05fSU5fU1VDQ0VTU19MSVNUSUQnKTtcclxuICAgIHRoaXMudHJpZ2dlck1haWxDaGltcFNlcnZpY2UodXNlciwgbGlzdElkKTtcclxuICB9XHJcbiAvKiBvblJlY3J1aXRlclNpZ25VcFN1Y2Nlc3ModXNlcjogYW55KSB7XHJcbiAgICBsZXQgbGlzdElkID0gY29uZmlnLmdldCgnVHBsU2VlZC5tYWlsLk1BSUxDSElNUF9SRUNSVUlURVJfU0lHTl9JTl9TVUNDRVNTX0xJU1RJRCcpO1xyXG4gICAgbGV0IG1kNVN0cmluZyA9IG1kNShjb25maWcuZ2V0KCdUcGxTZWVkLm1haWwuQURNSU5fTUFJTCcpKVxyXG4gICAgbWFpbGNoaW1wQ2xpZW50LnB1dCgnL2xpc3RzLycgKyBsaXN0SWQgKyAnL21lbWJlcnMvJyArIG1kNVN0cmluZywge1xyXG4gICAgICBlbWFpbF9hZGRyZXNzOiBjb25maWcuZ2V0KCdUcGxTZWVkLm1haWwuQURNSU5fTUFJTCcpLFxyXG4gICAgICBzdGF0dXM6ICdzdWJzY3JpYmVkJyxcclxuICAgICAgbWVyZ2VfZmllbGRzOiB7XHJcbiAgICAgICAgJ0NOQU1FJzogdXNlci5jb21wYW55X25hbWUsXHJcbiAgICAgICAgJ0NFTUFJTCc6dXNlci5lbWFpbFxyXG4gICAgICB9XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzOiBhbnkpIHtcclxuICAgICAgX2xvZ2dlclNlcnZpY2UubG9nSW5mbyhyZXN1bHRzKTtcclxuICAgIH0pXHJcbiAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyOiBhbnkpIHtcclxuICAgICAgICBfbG9nZ2VyU2VydmljZS5sb2dFcnJvcihlcnIpO1xyXG4gICAgICB9KVxyXG5cclxuICAgIHRoaXMudHJpZ2dlck1haWxDaGltcFNlcnZpY2UodXNlciwgbGlzdElkKTtcclxuICB9Ki9cclxuXHJcbiAgb25DYW5kaWRhdGVQb2ZpbGVTdWJtaXR0ZWQodXNlcjogYW55LCBpc1N1Ym1pdHRlZDpib29sZWFuLGlzRWRpdGluZ1Byb2ZpbGU6IGJvb2xlYW4pIHtcclxuICAgIGlmICghaXNFZGl0aW5nUHJvZmlsZSAmJiBpc1N1Ym1pdHRlZCkge1xyXG4gICAgICBsZXQgbGlzdElkID0gY29uZmlnLmdldCgnVHBsU2VlZC5tYWlsLk1BSUxDSElNUF9DQU5ESURBVEVfUFJPRklMRV9TVUJNSVRfU1VDQ0VTU19MSVNUSUQnKTtcclxuICAgICAgdGhpcy50cmlnZ2VyTWFpbENoaW1wU2VydmljZSh1c2VyLCBsaXN0SWQpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgb25Dcm9uSm9iQ2FuZGlkYXRlUHJvZmlsZVRyaWdnZXJlZChwcm9maWxlX3VwZGF0ZV90cmFjazpudW1iZXIsbGlzdElkOnN0cmluZykge1xyXG4gICAgdGhpcy5jYW5kaWRhdGVSZXBvc2l0b3J5ID0gbmV3IENhbmRpZGF0ZVJlcG9zaXRvcnkoKTtcclxuICAgIHRoaXMudXNlclJlcG9zaXRvcnkgPSBuZXcgVXNlclJlcG9zaXRvcnkoKTtcclxuXHJcbiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdmFyIHllc3RlcmRheSA9IG5ldyBEYXRlKHRvZGF5KTtcclxuICAgIHllc3RlcmRheS5zZXREYXRlKHRvZGF5LmdldERhdGUoKSAtIDEpO1xyXG4gICAgdmFyIGRhdGE7XHJcbiAgICBsZXQgdHJhY2tOdW1iZXI9Q2FuZGlkYXRlUHJvZmlsZVVwZGF0ZVRyYWNrU2VydmVyU2lkZS5TVEVQX0lTX0VOVEVSX0tFWV9TS0lMTFM7XHJcbiAgICBsZXQgdHJhY2tOdW1iZXJOb3RTdWJtaXR0ZWQ9Q2FuZGlkYXRlUHJvZmlsZVVwZGF0ZVRyYWNrU2VydmVyU2lkZS5TVEVQX0lTX1NVQk1JVF9ERVRBSUxTO1xyXG4gICAgaWYocHJvZmlsZV91cGRhdGVfdHJhY2s9PT10cmFja051bWJlcikge1xyXG4gICAgICAgZGF0YSA9IHtcclxuICAgICAgICAncHJvZmlsZV91cGRhdGVfdHJhY2tpbmcnOiB7JGd0ZTp0cmFja051bWJlciwkbHQ6dHJhY2tOdW1iZXJOb3RTdWJtaXR0ZWR9LFxyXG4gICAgICAgICdsYXN0VXBkYXRlQXQnOiB7JGx0OiBuZXcgRGF0ZSgpLCAkZ3Q6IG5ldyBEYXRlKHllc3RlcmRheSl9XHJcbiAgICAgIH07XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgIGRhdGEgPSB7XHJcbiAgICAgICAgJ3Byb2ZpbGVfdXBkYXRlX3RyYWNraW5nJzogcHJvZmlsZV91cGRhdGVfdHJhY2ssXHJcbiAgICAgICAgJ2xhc3RVcGRhdGVBdCc6IHskbHQ6IG5ldyBEYXRlKCksICRndDogbmV3IERhdGUoeWVzdGVyZGF5KX1cclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNhbmRpZGF0ZVJlcG9zaXRvcnkucmV0cmlldmVXaXRoSW5jbHVkZWQoZGF0YSwgeyd1c2VySWQnOiAxfSwgKGVycjphbnksIHJlczphbnkpID0+IHtcclxuICAgICAgaWYgKGVycikge1xyXG4gICAgICAgIF9sb2dnZXJTZXJ2aWNlLmxvZ0Vycm9yKGVycik7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgcmVzKSB7XHJcbiAgICAgICAgICB0aGlzLnVzZXJSZXBvc2l0b3J5LnJldHJpZXZlV2l0aEluY2x1ZGVkKHsnX2lkJzogaXRlbS51c2VySWR9LCB7J2VtYWlsJzogMSwnZmlyc3RfbmFtZSc6MSwnbGFzdF9uYW1lJzoxfSwgKGVycjphbnksIHJlczphbnkpID0+IHtcclxuICAgICAgICAgICAgaWYoZXJyKSB7XHJcbiAgICAgICAgICAgICAgX2xvZ2dlclNlcnZpY2UubG9nRXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgIHRoaXMudHJpZ2dlck1haWxDaGltcFNlcnZpY2UocmVzWzBdLCBsaXN0SWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRyaWdnZXJNYWlsQ2hpbXBTZXJ2aWNlKGRhdGE6YW55LGxpc3RJZDphbnkpIHtcclxuICAgIGxldCBtZDVTdHJpbmcgPSBtZDUoZGF0YS5lbWFpbClcclxuICAgIG1haWxjaGltcENsaWVudC5wdXQoJy9saXN0cy8nICsgbGlzdElkICsgJy9tZW1iZXJzLycgKyBtZDVTdHJpbmcsIHtcclxuICAgICAgZW1haWxfYWRkcmVzczogZGF0YS5lbWFpbCxcclxuICAgICAgc3RhdHVzOiAnc3Vic2NyaWJlZCcsXHJcbiAgICAgIG1lcmdlX2ZpZWxkczoge1xyXG4gICAgICAnRk5BTUUnOiBkYXRhLmZpcnN0X25hbWUsXHJcbiAgICAgICAgJ0xOQU1FJzpkYXRhLmxhc3RfbmFtZVxyXG4gICAgfVxyXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0czogYW55KSB7XHJcbiAgICAgIF9sb2dnZXJTZXJ2aWNlLmxvZ0luZm8ocmVzdWx0cyk7XHJcbiAgICB9KVxyXG4gICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycjogYW55KSB7XHJcbiAgICAgICAgX2xvZ2dlclNlcnZpY2UubG9nRXJyb3IoZXJyKTtcclxuICAgICAgfSlcclxuICB9XHJcbn1cclxuIl19
