"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Messages = require('./messages');
var logger = require('./logger/logger');
var UserService = require("../services/user.service");
function logHandler(err, req, res, next) {
    if (err.code) {
        logger.info(err);
        console.log('***Client error = ', err);
    }
    else {
        console.log('***Server error = ', err);
        logger.info(err);
    }
    next(err);
}
exports.logHandler = logHandler;
;
function errorHandler(err, req, res, next) {
    if (err.code) {
        logger.info(err);
        console.log('Error Handler');
        next(err);
    }
    else {
        var errObject = {
            'status': Messages.STATUS_ERROR,
            'error': {
                'reason': 'Internal Server ',
                'message': 'Internal Server ',
                'code': 500
            }
        };
        var responseObject = JSON.stringify(errObject);
        logger.info(responseObject);
        res.status(500).send(responseObject);
    }
}
exports.errorHandler = errorHandler;
;
function clientHandler(err, req, res, next) {
    console.log('Client Handler');
    var errObject = {
        status: Messages.STATUS_ERROR,
        error: err
    };
    var responseObject = JSON.stringify(errObject);
    logger.info(responseObject);
    mailToAdmin(err);
    console.log('responseObject in client errorHandler:', responseObject);
    res.status(err.code).send(responseObject);
}
exports.clientHandler = clientHandler;
;
function mailToAdmin(errorInfo) {
    console.log('mail the errorrs Handler');
    var userService = new UserService();
    userService.sendMailOnError(errorInfo, function (error, result) {
        if (error) {
            logger.error(Messages.MSG_ERROR_WHILE_CONTACTING);
        }
    });
}
;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9mcmFtZXdvcmsvc2hhcmVkL3NoYXJlZC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3JDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3hDLHNEQUF5RDtBQUV6RCxvQkFBMkIsR0FBUSxFQUFFLEdBQVEsRUFBRSxHQUFRLEVBQUUsSUFBUztJQUNoRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUNELElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNaLENBQUM7QUFURCxnQ0FTQztBQUFBLENBQUM7QUFHRixzQkFBNkIsR0FBUSxFQUFFLEdBQVEsRUFBRSxHQUFRLEVBQUUsSUFBUztJQUNsRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM3QixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDWixDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixJQUFJLFNBQVMsR0FBRztZQUNkLFFBQVEsRUFBRSxRQUFRLENBQUMsWUFBWTtZQUMvQixPQUFPLEVBQUU7Z0JBQ1AsUUFBUSxFQUFFLGtCQUFrQjtnQkFDNUIsU0FBUyxFQUFFLGtCQUFrQjtnQkFDN0IsTUFBTSxFQUFFLEdBQUc7YUFDWjtTQUNGLENBQUM7UUFDRixJQUFJLGNBQWMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDNUIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFFdkMsQ0FBQztBQUNILENBQUM7QUFuQkQsb0NBbUJDO0FBQUEsQ0FBQztBQUVGLHVCQUE4QixHQUFRLEVBQUUsR0FBUSxFQUFFLEdBQVEsRUFBRSxJQUFTO0lBQ25FLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUM5QixJQUFJLFNBQVMsR0FBRztRQUNkLE1BQU0sRUFBRSxRQUFRLENBQUMsWUFBWTtRQUM3QixLQUFLLEVBQUUsR0FBRztLQUNYLENBQUM7SUFDRixJQUFJLGNBQWMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDNUIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pCLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0NBQXdDLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDdEUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzVDLENBQUM7QUFYRCxzQ0FXQztBQUFBLENBQUM7QUFFRixxQkFBcUIsU0FBYTtJQUNoQyxPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLENBQUM7SUFDeEMsSUFBSSxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztJQUNwQyxXQUFXLENBQUMsZUFBZSxDQUFDLFNBQVMsRUFBRSxVQUFDLEtBQVMsRUFBRSxNQUFVO1FBQzNELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDVixNQUFNLENBQUMsS0FBSyxDQUFFLFFBQVEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQ3JELENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUVMLENBQUM7QUFBQSxDQUFDIiwiZmlsZSI6ImFwcC9mcmFtZXdvcmsvc2hhcmVkL3NoYXJlZC5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIE1lc3NhZ2VzID0gcmVxdWlyZSgnLi9tZXNzYWdlcycpO1xyXG52YXIgbG9nZ2VyID0gcmVxdWlyZSgnLi9sb2dnZXIvbG9nZ2VyJyk7XHJcbmltcG9ydCBVc2VyU2VydmljZSA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3VzZXIuc2VydmljZScpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0hhbmRsZXIoZXJyOiBhbnksIHJlcTogYW55LCByZXM6IGFueSwgbmV4dDogYW55KSB7XHJcbiAgaWYgKGVyci5jb2RlKSB7XHJcbiAgICBsb2dnZXIuaW5mbyhlcnIpO1xyXG4gICAgY29uc29sZS5sb2coJyoqKkNsaWVudCBlcnJvciA9ICcsIGVycik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnNvbGUubG9nKCcqKipTZXJ2ZXIgZXJyb3IgPSAnLCBlcnIpO1xyXG4gICAgbG9nZ2VyLmluZm8oZXJyKTtcclxuICB9XHJcbiAgbmV4dChlcnIpO1xyXG59O1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBlcnJvckhhbmRsZXIoZXJyOiBhbnksIHJlcTogYW55LCByZXM6IGFueSwgbmV4dDogYW55KSB7XHJcbiAgaWYgKGVyci5jb2RlKSB7XHJcbiAgICBsb2dnZXIuaW5mbyhlcnIpO1xyXG4gICAgY29uc29sZS5sb2coJ0Vycm9yIEhhbmRsZXInKTtcclxuICAgIG5leHQoZXJyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdmFyIGVyck9iamVjdCA9IHtcclxuICAgICAgJ3N0YXR1cyc6IE1lc3NhZ2VzLlNUQVRVU19FUlJPUixcclxuICAgICAgJ2Vycm9yJzoge1xyXG4gICAgICAgICdyZWFzb24nOiAnSW50ZXJuYWwgU2VydmVyICcsXHJcbiAgICAgICAgJ21lc3NhZ2UnOiAnSW50ZXJuYWwgU2VydmVyICcsXHJcbiAgICAgICAgJ2NvZGUnOiA1MDBcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHZhciByZXNwb25zZU9iamVjdCA9IEpTT04uc3RyaW5naWZ5KGVyck9iamVjdCk7XHJcbiAgICBsb2dnZXIuaW5mbyhyZXNwb25zZU9iamVjdCk7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuc2VuZChyZXNwb25zZU9iamVjdCk7XHJcblxyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGllbnRIYW5kbGVyKGVycjogYW55LCByZXE6IGFueSwgcmVzOiBhbnksIG5leHQ6IGFueSkge1xyXG4gIGNvbnNvbGUubG9nKCdDbGllbnQgSGFuZGxlcicpO1xyXG4gIHZhciBlcnJPYmplY3QgPSB7XHJcbiAgICBzdGF0dXM6IE1lc3NhZ2VzLlNUQVRVU19FUlJPUixcclxuICAgIGVycm9yOiBlcnJcclxuICB9O1xyXG4gIHZhciByZXNwb25zZU9iamVjdCA9IEpTT04uc3RyaW5naWZ5KGVyck9iamVjdCk7XHJcbiAgbG9nZ2VyLmluZm8ocmVzcG9uc2VPYmplY3QpO1xyXG4gIG1haWxUb0FkbWluKGVycik7XHJcbiAgY29uc29sZS5sb2coJ3Jlc3BvbnNlT2JqZWN0IGluIGNsaWVudCBlcnJvckhhbmRsZXI6JywgcmVzcG9uc2VPYmplY3QpO1xyXG4gIHJlcy5zdGF0dXMoZXJyLmNvZGUpLnNlbmQocmVzcG9uc2VPYmplY3QpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gbWFpbFRvQWRtaW4oZXJyb3JJbmZvOmFueSkge1xyXG4gIGNvbnNvbGUubG9nKCdtYWlsIHRoZSBlcnJvcnJzIEhhbmRsZXInKTtcclxuICB2YXIgdXNlclNlcnZpY2UgPSBuZXcgVXNlclNlcnZpY2UoKTtcclxuICB1c2VyU2VydmljZS5zZW5kTWFpbE9uRXJyb3IoZXJyb3JJbmZvLCAoZXJyb3I6YW55LCByZXN1bHQ6YW55KSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgbG9nZ2VyLmVycm9yKCBNZXNzYWdlcy5NU0dfRVJST1JfV0hJTEVfQ09OVEFDVElORyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG59O1xyXG4iXX0=
