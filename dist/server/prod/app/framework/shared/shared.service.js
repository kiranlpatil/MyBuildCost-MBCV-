"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Messages = require('./messages');
var logger = require('./logger/logger');
var UserService = require("../services/user.service");
function logHandler(err, req, res, next) {
    if (err.code) {
        logger.info(err);
        console.log('***Client error = ', err);
    }
    else {
        console.log('***Server error = ', err);
        logger.info(err);
    }
    next(err);
}
exports.logHandler = logHandler;
;
function errorHandler(err, req, res, next) {
    if (err.code) {
        logger.info(err);
        console.log('Error Handler');
        next(err);
    }
    else {
        var errObject = {
            'status': Messages.STATUS_ERROR,
            'error': {
                'reason': 'Internal Server ',
                'message': 'Internal Server ',
                'code': 500
            }
        };
        var responseObject = JSON.stringify(errObject);
        logger.info(responseObject);
        res.status(500).send(responseObject);
    }
}
exports.errorHandler = errorHandler;
;
function clientHandler(err, req, res, next) {
    console.log('Client Handler');
    var errObject = {
        status: Messages.STATUS_ERROR,
        error: err
    };
    var responseObject = JSON.stringify(errObject);
    logger.info(responseObject);
    mailToAdmin(err);
    console.log('responseObject in client errorHandler:', responseObject);
    res.status(err.code).send(responseObject);
}
exports.clientHandler = clientHandler;
;
function mailToAdmin(errorInfo) {
    console.log('mail the errorrs Handler');
    var userService = new UserService();
    userService.sendMailOnError(errorInfo, function (error, result) {
        if (error) {
            logger.error(Messages.MSG_ERROR_WHILE_CONTACTING);
        }
    });
}
;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9mcmFtZXdvcmsvc2hhcmVkL3NoYXJlZC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3JDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3hDLHNEQUF5RDtBQUV6RCxvQkFBMkIsR0FBUSxFQUFFLEdBQVEsRUFBRSxHQUFRLEVBQUUsSUFBUztJQUNoRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUNELElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNaLENBQUM7QUFURCxnQ0FTQztBQUFBLENBQUM7QUFHRixzQkFBNkIsR0FBUSxFQUFFLEdBQVEsRUFBRSxHQUFRLEVBQUUsSUFBUztJQUNsRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM3QixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDWixDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixJQUFJLFNBQVMsR0FBRztZQUNkLFFBQVEsRUFBRSxRQUFRLENBQUMsWUFBWTtZQUMvQixPQUFPLEVBQUU7Z0JBQ1AsUUFBUSxFQUFFLGtCQUFrQjtnQkFDNUIsU0FBUyxFQUFFLGtCQUFrQjtnQkFDN0IsTUFBTSxFQUFFLEdBQUc7YUFDWjtTQUNGLENBQUM7UUFDRixJQUFJLGNBQWMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDNUIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFFdkMsQ0FBQztBQUNILENBQUM7QUFuQkQsb0NBbUJDO0FBQUEsQ0FBQztBQUVGLHVCQUE4QixHQUFRLEVBQUUsR0FBUSxFQUFFLEdBQVEsRUFBRSxJQUFTO0lBQ25FLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUM5QixJQUFJLFNBQVMsR0FBRztRQUNkLE1BQU0sRUFBRSxRQUFRLENBQUMsWUFBWTtRQUM3QixLQUFLLEVBQUUsR0FBRztLQUNYLENBQUM7SUFDRixJQUFJLGNBQWMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDNUIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2pCLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0NBQXdDLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDdEUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzVDLENBQUM7QUFYRCxzQ0FXQztBQUFBLENBQUM7QUFFRixxQkFBcUIsU0FBYTtJQUNoQyxPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDLENBQUM7SUFDeEMsSUFBSSxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztJQUNwQyxXQUFXLENBQUMsZUFBZSxDQUFDLFNBQVMsRUFBRSxVQUFDLEtBQVMsRUFBRSxNQUFVO1FBQzNELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDVixNQUFNLENBQUMsS0FBSyxDQUFFLFFBQVEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQ3JELENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUVMLENBQUM7QUFBQSxDQUFDIiwiZmlsZSI6ImFwcC9mcmFtZXdvcmsvc2hhcmVkL3NoYXJlZC5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIE1lc3NhZ2VzID0gcmVxdWlyZSgnLi9tZXNzYWdlcycpO1xudmFyIGxvZ2dlciA9IHJlcXVpcmUoJy4vbG9nZ2VyL2xvZ2dlcicpO1xuaW1wb3J0IFVzZXJTZXJ2aWNlID0gcmVxdWlyZSgnLi4vc2VydmljZXMvdXNlci5zZXJ2aWNlJyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dIYW5kbGVyKGVycjogYW55LCByZXE6IGFueSwgcmVzOiBhbnksIG5leHQ6IGFueSkge1xuICBpZiAoZXJyLmNvZGUpIHtcbiAgICBsb2dnZXIuaW5mbyhlcnIpO1xuICAgIGNvbnNvbGUubG9nKCcqKipDbGllbnQgZXJyb3IgPSAnLCBlcnIpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKCcqKipTZXJ2ZXIgZXJyb3IgPSAnLCBlcnIpO1xuICAgIGxvZ2dlci5pbmZvKGVycik7XG4gIH1cbiAgbmV4dChlcnIpO1xufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKGVycjogYW55LCByZXE6IGFueSwgcmVzOiBhbnksIG5leHQ6IGFueSkge1xuICBpZiAoZXJyLmNvZGUpIHtcbiAgICBsb2dnZXIuaW5mbyhlcnIpO1xuICAgIGNvbnNvbGUubG9nKCdFcnJvciBIYW5kbGVyJyk7XG4gICAgbmV4dChlcnIpO1xuICB9IGVsc2Uge1xuICAgIHZhciBlcnJPYmplY3QgPSB7XG4gICAgICAnc3RhdHVzJzogTWVzc2FnZXMuU1RBVFVTX0VSUk9SLFxuICAgICAgJ2Vycm9yJzoge1xuICAgICAgICAncmVhc29uJzogJ0ludGVybmFsIFNlcnZlciAnLFxuICAgICAgICAnbWVzc2FnZSc6ICdJbnRlcm5hbCBTZXJ2ZXIgJyxcbiAgICAgICAgJ2NvZGUnOiA1MDBcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciByZXNwb25zZU9iamVjdCA9IEpTT04uc3RyaW5naWZ5KGVyck9iamVjdCk7XG4gICAgbG9nZ2VyLmluZm8ocmVzcG9uc2VPYmplY3QpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHJlc3BvbnNlT2JqZWN0KTtcblxuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY2xpZW50SGFuZGxlcihlcnI6IGFueSwgcmVxOiBhbnksIHJlczogYW55LCBuZXh0OiBhbnkpIHtcbiAgY29uc29sZS5sb2coJ0NsaWVudCBIYW5kbGVyJyk7XG4gIHZhciBlcnJPYmplY3QgPSB7XG4gICAgc3RhdHVzOiBNZXNzYWdlcy5TVEFUVVNfRVJST1IsXG4gICAgZXJyb3I6IGVyclxuICB9O1xuICB2YXIgcmVzcG9uc2VPYmplY3QgPSBKU09OLnN0cmluZ2lmeShlcnJPYmplY3QpO1xuICBsb2dnZXIuaW5mbyhyZXNwb25zZU9iamVjdCk7XG4gIG1haWxUb0FkbWluKGVycik7XG4gIGNvbnNvbGUubG9nKCdyZXNwb25zZU9iamVjdCBpbiBjbGllbnQgZXJyb3JIYW5kbGVyOicsIHJlc3BvbnNlT2JqZWN0KTtcbiAgcmVzLnN0YXR1cyhlcnIuY29kZSkuc2VuZChyZXNwb25zZU9iamVjdCk7XG59O1xuXG5mdW5jdGlvbiBtYWlsVG9BZG1pbihlcnJvckluZm86YW55KSB7XG4gIGNvbnNvbGUubG9nKCdtYWlsIHRoZSBlcnJvcnJzIEhhbmRsZXInKTtcbiAgdmFyIHVzZXJTZXJ2aWNlID0gbmV3IFVzZXJTZXJ2aWNlKCk7XG4gIHVzZXJTZXJ2aWNlLnNlbmRNYWlsT25FcnJvcihlcnJvckluZm8sIChlcnJvcjphbnksIHJlc3VsdDphbnkpID0+IHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvciggTWVzc2FnZXMuTVNHX0VSUk9SX1dISUxFX0NPTlRBQ1RJTkcpO1xuICAgIH1cbiAgfSk7XG5cbn07XG4iXX0=
