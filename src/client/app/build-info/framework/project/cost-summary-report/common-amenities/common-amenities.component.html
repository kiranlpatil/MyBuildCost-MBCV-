<!--TODO: make separate component for Common Amminities-->

  <div class="panel panel-default"  *ngIf="amenitiesReport !== undefined" >
    <div class="panel-heading">
      <h4 class="panel-title">
        <a id="collapse-cost-summary-panel{{totalNumberOfBuildings}}" class="collapsed" data-parent="#cost-summary-panel" data-toggle="collapse" href="#collapse{{totalNumberOfBuildings}}" (click)="showGrandTotalTable()">
          {{getHeadings().COMMON_DEVELOPMENT}}
          <span class="slab-area">
                  {{ getLabel().TOTAL }} {{(costingByArea === getProjectElements().SLAB_AREA) ? 'Slab Area' : ((costingByArea === getProjectElements().SALEABLE_AREA) ? 'Saleable Area' : 'Carpet Area')}} : {{ grandTotalOfArea| number: '1.0-0' }} {{ (costingByUnit === getProjectElements().RS_PER_SQFT) ? getProjectElements().SQUAREFEET : getProjectElements().SQUAREMETER }}
          </span>
          <span class="caret"></span>
        </a>
      </h4>
      <div class="dropdown menu-items">
        <a title="Download/Print" class="dropdown-toggle" data-toggle="dropdown">
          <img src="assets/build-info/dashboard/dots.png" />
        </a>
        <ul class="dropdown-menu">
          <li class="first-child-list">
            <div class="download-pdf-list">
              <span><span class="glyphicon glyphicon-print"></span>&nbsp;&nbsp;Download/Print</span>
              <common-amenities-report-pdf [amenitiesReport]="amenitiesReport"
                                           [costingByUnit]="costingByUnit"
                                           [costingByArea]="costingByArea"
                                           [grandTotalOfArea]="grandTotalOfArea">
              </common-amenities-report-pdf>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <table class="table table-row-spacing table-dashboard cost-summary-table">
      <thead class="cost-summary-table-header">
        <tr>
          <th rowspan="2" class="border-left">{{getLabel().AMENITY_COST_HEAD}}</th>
          <th colspan="2" class="border-left table-heading">
            {{getLabel().BUDGETED_COST}}
            <span class="sub-heading">( {{ getLabel().REPORT_BY_THUMBRULE }} )</span>
            <div class="white-bg"></div>
          </th>
          <th colspan="5" class="border-left table-heading">
            {{getLabel().ESTIMATED}} <span class="sub-heading">{{getLabel().AS_PER_PROJECT}}</span>
            <div class="white-bg"></div>
          </th>
        </tr>
        <tr class="cost-summary-row-list">
          <th class="text-center"><span class="sub-heading">{{costingByUnit}}<br/>Per {{(costingByArea === getProjectElements().SLAB_AREA) ? getProjectElements().SLAB_AREA : ((costingByArea ===getProjectElements().SALEABLE_AREA) ? getProjectElements().SALEABLE_AREA : getProjectElements().CARPET_AREA)}}</span></th>
          <th class="border-left"><span class="sub-heading">{{getLabel().BUDGETED_COST}}</span></th>
          <th class="border-left"><span class="sub-heading">{{getLabel().BASIC_ESTIMATED_COST}}</span></th>
          <th class="border-left"><span class="sub-heading">{{getLabel().GST_COMPONENT}}</span></th>
          <th><span class="sub-heading">{{getLabel().TOTAL_ESTIMATED_COST}}</span></th>
          <th><span class="sub-heading">{{costingByUnit}}<br/>Per {{(costingByArea === getProjectElements().SLAB_AREA) ? getProjectElements().SLAB_AREA : ((costingByArea === getProjectElements().SALEABLE_AREA) ? getProjectElements().SALEABLE_AREA : getProjectElements().CARPET_AREA)}} without {{getLabel().GST_COMPONENT}}</span></th>
          <th><span class="sub-heading">{{costingByUnit}}<br/>Per {{(costingByArea === getProjectElements().SLAB_AREA) ? getProjectElements().SLAB_AREA : ((costingByArea === getProjectElements().SALEABLE_AREA) ? getProjectElements().SALEABLE_AREA : getProjectElements().CARPET_AREA)}} with {{getLabel().GST_COMPONENT}}</span></th>
        </tr>
      </thead>
    </table>

    <div id="collapse{{totalNumberOfBuildings}}" class="panel-collapse collapse">
      <div class="panel-body">

        <table class="table table-row-spacing table-dashboard cost-summary-table">
          <tbody *ngIf="amenitiesReport.thumbRule  && amenitiesReport.estimate" >
            <tr *ngFor="let thumbRuleItem of amenitiesReport.thumbRule.thumbRuleReports; let currentAmenitieIndex = index" class="delete-cost-head-cell">
              <td class="border-left">{{thumbRuleItem.name}}</td>
              <td class="visible-xs"><p>{{ getLabel().REPORT_BY_THUMBRULE }}</p></td>
              <td class="border-left">
                <span class="mobile-headings">{{ costingByUnit }} </span>
                <span *ngIf="thumbRuleItem.rate !== 0">{{thumbRuleItem.rate| number: '1.2-2'}}</span>
                <span *ngIf="thumbRuleItem.rate === 0">-</span>
              </td>
              <td class="border-left" [class.validate-amount] = 'thumbRuleItem?.amount?.toString().split(".")[0]?.length>9 ||
                                                          thumbRuleItem?.amount?.toString().split(".")[1]?.length>4'>
                <span class="mobile-headings">{{ getLabel().BUDGETED_COST }} </span>
                 <span class="budgeted-amount" *ngIf="thumbRuleItem.amount !== 0">
                      {{thumbRuleItem.amount | number: '1.0-0'  }}
                  </span>
                  <span class="budgeted-amount" *ngIf="thumbRuleItem.amount === 0">-</span>
                <div class="edit-field">
                  <input title="Edit Budgeted Cost" type="number" amountValidate="true"
                         [(ngModel)]="thumbRuleItem.amount"
                         id="thumbRuleItem.amount"
                         (blur)="changeBudgetedCostAmountOfProjectCostHead(thumbRuleItem.name, thumbRuleItem.amount)"
                         class="form-control clear"/>
                </div>
              </td>
              <td class="visible-xs padding-top0"><p class="border-top">{{ getLabel().ESTIMATED }}</p></td>
              <td class="border-left" id="basicEstimatedCost"><span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].basicEstimatedCost === 0">-</span>
              <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].basicEstimatedCost!== 0">
                {{amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].basicEstimatedCost | number: '1.0-0'}}
              </span>
              </td>
              <td class="border-left" id="gstComponent">
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].gstComponent === 0">-</span>
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].gstComponent !== 0">
                  {{amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].gstComponent| number: '1.0-0'}}
                </span>
              </td>
              <td>
                <span class="mobile-headings">{{ getLabel().TOTAL_ESTIMATED_COST }}</span>
                <div *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total != 0"
                     (click)="goToCostHeadView(amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex])">
                          <span  class="estimated-cost"
                                 [class.above-cost]="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total > thumbRuleItem.amount"
                                 [class.below-cost]="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total < thumbRuleItem.amount">
                            {{amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total | number: '1.0-0' }}
                          </span>
                </div>
                <button *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total == 0"
                      type="button" class="btn-get-amount" title="Estimate Cost"
                        (click)="goToCostHeadView(amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex])">{{getButton().GET_AMOUNT}}</button>
              </td>
              <td class="border-left" id="rateWithoutGst">
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rateWithoutGst === 0">-</span>
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rateWithoutGst !== 0">
                  {{amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rateWithoutGst | number: '1.2-2'}}
                </span>
              </td>
              <td class="border-left">
                <span class="mobile-headings">{{ costingByUnit }} </span>
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rate === 0">-</span>
                <span *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rate !== 0">
                        {{amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rate | number: '1.2-2'}}
                </span>
              </td>
            <!--  <td>
                <div class="edit-field" *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total != 0"
                     (click)="goToCostHeadView(amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex])">
                  <input [(ngModel)]="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total"
                         id="estimatedItem.total">
                </div>
                <button type="button" *ngIf="amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].total == 0"
                        class="btn-get-amount" (click)="goToCostHeadView(amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex])">{{getButton().GET_AMOUNT}}</button>
              </td>-->

              <td class="delete-cost-head">
                <div data-toggle="modal"
                     data-target="#deleteCosthead"
                     (click)="setIdsToInActiveCostHead(amenitiesReport.estimate.estimatedCosts[currentAmenitieIndex].rateAnalysisId)">
                  <img alt="Delete Cost Head" title="Delete Cost Head" src="assets/build-info/dashboard/delete.png" />
                </div>
              </td>
            </tr>
            <tr *ngIf="showProjectCostHeadList" class="add-cost-head">
              <td class="border-left">
                <select class="select-item" (change)="onChangeActiveSelectedCostHead($event.target.value)">
                  <option>Select Item</option>
                  <option *ngFor="let projectCostHead of inActiveProjectCostHeads" [value]="projectCostHead.rateAnalysisId">
                    {{ projectCostHead.name }}
                  </option>
                </select>
              </td>
              <td colspan="5">&nbsp;</td>
            </tr>
            <tr class="add-item-row hidden-xs">
              <td colspan="5" class="add-items">
                <button title="Add Cost Head" type="button" class="btn btn-add-item"
                        (click)="getAllInActiveProjectCostHeads()" [disabled]="showHideCostHeadButtonList[showHideCostHeadButtonList.length-1].showHideAddCostHeadButton">
                  <span class="glyphicon glyphicon-plus"></span>{{ getButton().ADD }} {{ getButton().COSTHEAD }}
                </button>
              </td>
            </tr>
            <!--<tr class="total" *ngIf="amenitiesReport.thumbRule && amenitiesReport.estimate && !showGrandTotalPanelTable">
              <td class="border-left">{{getLabel().TOTAL}}</td>
              <td class="visible-xs"><p>{{ getLabel().REPORT_BY_THUMBRULE }}</p></td>
              <td class="border-left">
                <span class="mobile-headings">{{ costingByUnit }} </span>
                <span *ngIf="amenitiesReport.thumbRule.totalRate === 0">-</span>
                <span *ngIf="amenitiesReport.thumbRule.totalRate !== 0">{{amenitiesReport.thumbRule.totalRate|number: '1.2-2'}}</span>
              </td>
              <td class="border-left">
                <span class="mobile-headings">{{ getLabel().BUDGETED_COST }} </span>
                <span class="estimated-cost" *ngIf="amenitiesReport.thumbRule.totalBudgetedCost === 0">-</span>
                <span class="estimated-cost" *ngIf="amenitiesReport.thumbRule.totalBudgetedCost !== 0">
                  {{amenitiesReport.thumbRule.totalBudgetedCost|number: '1.0-0'}}
                </span>
              </td>
              <td class="visible-xs padding-top0"><p class="border-top">{{ getLabel().ESTIMATED }}</p></td>
              <td class="border-left">
                <span class="mobile-headings">{{ costingByUnit }} </span>
                <span *ngIf="amenitiesReport.estimate.totalRate === 0">-</span>
                <span *ngIf="amenitiesReport.estimate.totalRate !== 0">
                  {{amenitiesReport.estimate.totalRate|number: '1.2-2'}}
                </span>
              </td>
              <td class="border-left">
                <span class="mobile-headings">{{ getLabel().ESTIMATED_COST }} </span>
                <span class="estimated-cost" *ngIf="amenitiesReport.estimate.totalEstimatedCost === 0">-</span>
                <span class="estimated-cost" *ngIf="amenitiesReport.estimate.totalEstimatedCost !== 0">
                    {{amenitiesReport.estimate.totalEstimatedCost|number: '1.0-0'}}
                </span>
              </td>
            </tr>-->
          </tbody>
        </table>
      </div>
    </div>

    <table class="table table-row-spacing table-dashboard total-table">
      <tbody>
        <tr class="total" *ngIf="amenitiesReport.thumbRule && amenitiesReport.estimate">
          <td class="border-left">{{getLabel().TOTAL}}</td>
          <td class="visible-xs"><p>{{ getLabel().REPORT_BY_THUMBRULE }}</p></td>
          <td class="border-left">
            <span class="mobile-headings">{{ costingByUnit }} </span>
            <span *ngIf="amenitiesReport.thumbRule.totalRate === 0">-</span>
            <span *ngIf="amenitiesReport.thumbRule.totalRate !== 0">{{amenitiesReport.thumbRule.totalRate|number: '1.2-2'}}</span>
          </td>
          <td class="border-left">
            <span class="mobile-headings">{{ getLabel().BUDGETED_COST }}</span>
            <span class="estimated-cost" *ngIf="amenitiesReport.thumbRule.totalBudgetedCost === 0">-</span>
            <span class="estimated-cost" *ngIf="amenitiesReport.thumbRule.totalBudgetedCost !== 0">
              {{amenitiesReport.thumbRule.totalBudgetedCost|number: '1.0-0'}}
            </span>
          </td>
          <td>
            <span class="mobile-headings">{{ getLabel().BASIC_ESTIMATED_COST }}</span>
            <span *ngIf="amenitiesReport.estimate.totalBasicEstimatedCost ===0">-</span>
            <span *ngIf="amenitiesReport.estimate.totalBasicEstimatedCost !==0">{{amenitiesReport.estimate.totalBasicEstimatedCost|number: '1.0-0'}}</span>
          </td>
          <td>
            <span class="mobile-headings">{{ getLabel().GST_COMPONENT }}</span>
            <span *ngIf="amenitiesReport.estimate.totalGstComponent ===0">-</span>
            <span *ngIf="amenitiesReport.estimate.totalGstComponent !==0">{{amenitiesReport.estimate.totalGstComponent|number: '1.0-0'}}</span>
          </td>
          <td class="border-left">
            <span class="mobile-headings">{{ getLabel().ESTIMATED_COST }} </span>
            <span class="estimated-cost" *ngIf="amenitiesReport.estimate.totalEstimatedCost === 0">-</span>
            <span class="estimated-cost" *ngIf="amenitiesReport.estimate.totalEstimatedCost !== 0">
              {{amenitiesReport.estimate.totalEstimatedCost|number: '1.0-0'}}
            </span>
          </td>
          <td>
            <span class="mobile-headings">{{ costingByUnit }} </span>
            <span *ngIf="amenitiesReport.estimate.totalRateWithoutGst ===0">-</span>
            <span *ngIf="amenitiesReport.estimate.totalRateWithoutGst !==0">{{amenitiesReport.estimate.totalRateWithoutGst|number: '1.2-2'}}</span>
          </td>
          <td class="visible-xs padding-top0"><p class="border-top">{{ getLabel().ESTIMATED }}</p></td>
          <td class="border-left">
            <span class="mobile-headings">{{ costingByUnit }} </span>
            <span *ngIf="amenitiesReport.estimate.totalRate === 0">-</span>
            <span *ngIf="amenitiesReport.estimate.totalRate !== 0">
              {{amenitiesReport.estimate.totalRate|number: '1.2-2'}}
            </span>
          </td>

        </tr>
      </tbody>
    </table>
  </div>
  <div class="modal fade default-modal" id="deleteCosthead" role="dialog">
    <bi-delete-confirmation-modal [elementType]="deleteConfirmationCostHead" (deleteElementEvent)="deleteProjectCostHead($event)"></bi-delete-confirmation-modal>
  </div>
